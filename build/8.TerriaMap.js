/*! For license information please see 8.TerriaMap.js.LICENSE.txt */
((self||window).webpackJsonp=(self||window).webpackJsonp||[]).push([[8],{2446:function(t,e){!function(t){"use strict";const e="This constructor is not a subclass of Float16Array",r="The constructor property value is not an object",i="Attempting to access detached ArrayBuffer",n="Cannot convert undefined or null to object",s="Cannot mix BigInt and other types, use explicit conversions",o="@@iterator property is not callable",a="Reduce of empty array with no initial value",l="Offset is out of bounds";function h(t){return(e,...r)=>f(t,e,r)}function c(t,e){return h(p(t,e).get)}const{apply:f,construct:u,defineProperty:g,get:d,getOwnPropertyDescriptor:p,getPrototypeOf:m,has:w,ownKeys:y,set:C,setPrototypeOf:A}=Reflect,I=Proxy,{EPSILON:b,MAX_SAFE_INTEGER:v,isFinite:S,isNaN:D}=Number,{iterator:E,species:x,toStringTag:_,for:T}=Symbol,B=Object,{create:R,defineProperty:G,freeze:F,is:O}=B,P=B.prototype,M=P.__lookupGetter__?h(P.__lookupGetter__):(t,e)=>{if(null==t)throw Rt(n);let r=B(t);do{const t=p(r,e);if(void 0!==t)return k(t,"get")?t.get:void 0}while(null!==(r=m(r)))},k=B.hasOwn||h(P.hasOwnProperty),U=Array,L=U.isArray,N=U.prototype,V=h(N.join),j=h(N.push),H=h(N.toLocaleString),Z=N[E],W=h(Z),{abs:X,trunc:Y}=Math,K=ArrayBuffer,z=K.isView,q=K.prototype,J=h(q.slice),$=c(q,"byteLength"),Q="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:null,tt=Q&&c(Q.prototype,"byteLength"),et=m(Uint8Array),rt=et.from,it=et.prototype,nt=it[E],st=h(it.keys),ot=h(it.values),at=h(it.entries),lt=h(it.set),ht=h(it.reverse),ct=h(it.fill),ft=h(it.copyWithin),ut=h(it.sort),gt=h(it.slice),dt=h(it.subarray),pt=c(it,"buffer"),mt=c(it,"byteOffset"),wt=c(it,"length"),yt=c(it,_),Ct=Uint8Array,At=Uint16Array,It=(...t)=>f(rt,At,t),bt=Uint32Array,vt=Float32Array,St=m([][E]()),Dt=h(St.next),Et=h(function*(){}().next),xt=m(St),_t=DataView.prototype,Tt=h(_t.getUint16),Bt=h(_t.setUint16),Rt=TypeError,Gt=RangeError,Ft=WeakSet,Ot=Ft.prototype,Pt=h(Ot.add),Mt=h(Ot.has),kt=WeakMap,Ut=kt.prototype,Lt=h(Ut.get),Nt=h(Ut.has),Vt=h(Ut.set),jt=new kt,Ht=R(null,{next:{value:function(){const t=Lt(jt,this);return Dt(t)}},[E]:{value:function(){return this}}});function Zt(t){if(t[E]===Z&&St.next===Dt)return t;const e=R(Ht);return Vt(jt,e,W(t)),e}const Wt=new kt,Xt=R(xt,{next:{value:function(){const t=Lt(Wt,this);return Et(t)},writable:!0,configurable:!0}});for(const t of y(St))"next"!==t&&G(Xt,t,p(St,t));function Yt(t){const e=R(Xt);return Vt(Wt,e,t),e}function Kt(t){return null!==t&&"object"==typeof t||"function"==typeof t}function zt(t){return null!==t&&"object"==typeof t}function qt(t){return void 0!==yt(t)}function Jt(t){const e=yt(t);return"BigInt64Array"===e||"BigUint64Array"===e}function $t(t){if(null===Q)return!1;try{return tt(t),!0}catch(t){return!1}}function Qt(t){return function(t){try{return!L(t)&&($(t),!0)}catch(t){return!1}}(t)||$t(t)}function te(t){return!!L(t)&&(t[E]===Z&&St.next===Dt)}function ee(t){if("string"!=typeof t)return!1;const e=+t;return t===e+""&&(!!S(e)&&e===Y(e))}const re=T("__Float16Array__");const ie=1/b;const ne=6103515625e-14,se=.0009765625,oe=5.960464477539063e-8,ae=se*ie;function le(t){const e=+t;if(!S(e)||0===e)return e;const r=e>0?1:-1,i=X(e);if(i<ne)return r*function(t){return t+ie-ie}(i/oe)*oe;const n=(1+ae)*i,s=n-(n-i);return s>65504||D(s)?r*(1/0):r*s}const he=new K(4),ce=new vt(he),fe=new bt(he),ue=new At(512),ge=new Ct(512);for(let t=0;t<256;++t){const e=t-127;e<-24?(ue[t]=0,ue[256|t]=32768,ge[t]=24,ge[256|t]=24):e<-14?(ue[t]=1024>>-e-14,ue[256|t]=1024>>-e-14|32768,ge[t]=-e-1,ge[256|t]=-e-1):e<=15?(ue[t]=e+15<<10,ue[256|t]=e+15<<10|32768,ge[t]=13,ge[256|t]=13):e<128?(ue[t]=31744,ue[256|t]=64512,ge[t]=24,ge[256|t]=24):(ue[t]=31744,ue[256|t]=64512,ge[t]=13,ge[256|t]=13)}function de(t){ce[0]=le(t);const e=fe[0],r=e>>23&511;return ue[r]+((8388607&e)>>ge[r])}const pe=new bt(2048);for(let t=1;t<1024;++t){let e=t<<13,r=0;for(;!(8388608&e);)e<<=1,r-=8388608;e&=-8388609,r+=947912704,pe[t]=e|r}for(let t=1024;t<2048;++t)pe[t]=939524096+(t-1024<<13);const me=new bt(64);for(let t=1;t<31;++t)me[t]=t<<23;me[31]=1199570944,me[32]=2147483648;for(let t=33;t<63;++t)me[t]=2147483648+(t-32<<23);me[63]=3347054592;const we=new At(64);for(let t=1;t<64;++t)32!==t&&(we[t]=1024);function ye(t){const e=t>>10;return fe[0]=pe[we[e]+(1023&t)]+me[e],ce[0]}function Ce(t){const e=+t;return D(e)||0===e?0:Y(e)}function Ae(t){const e=Ce(t);return e<0?0:e<v?e:v}function Ie(t,e){if(!Kt(t))throw Rt("This is not an object");const i=t.constructor;if(void 0===i)return e;if(!Kt(i))throw Rt(r);const n=i[x];return null==n?e:n}function be(t){if($t(t))return!1;try{return J(t,0,0),!1}catch(t){}return!0}function ve(t,e){const r=D(t),i=D(e);if(r&&i)return 0;if(r)return 1;if(i)return-1;if(t<e)return-1;if(t>e)return 1;if(0===t&&0===e){const r=O(t,0),i=O(e,0);if(!r&&i)return-1;if(r&&!i)return 1}return 0}const Se=new kt;function De(t){return Nt(Se,t)||!z(t)&&function(t){if(!zt(t))return!1;const e=m(t);if(!zt(e))return!1;const i=e.constructor;if(void 0===i)return!1;if(!Kt(i))throw Rt(r);return w(i,re)}(t)}function Ee(t){if(!De(t))throw Rt("This is not a Float16Array object")}function xe(t,e){const r=De(t),i=qt(t);if(!r&&!i)throw Rt("Species constructor didn't return TypedArray object");if("number"==typeof e){let i;if(r){const e=_e(t);i=wt(e)}else i=wt(t);if(i<e)throw Rt("Derived constructor created TypedArray object which was too small length")}if(Jt(t))throw Rt(s)}function _e(t){const e=Lt(Se,t);if(void 0!==e){if(be(pt(e)))throw Rt(i);return e}const r=t.buffer;if(be(r))throw Rt(i);const n=u(Ge,[r,t.byteOffset,t.length],t.constructor);return Lt(Se,n)}function Te(t){const e=wt(t),r=[];for(let i=0;i<e;++i)r[i]=ye(t[i]);return r}const Be=new Ft;for(const t of y(it)){if(t===_)continue;const e=p(it,t);k(e,"get")&&"function"==typeof e.get&&Pt(Be,e.get)}const Re=F({get:(t,e,r)=>ee(e)&&k(t,e)?ye(d(t,e)):Mt(Be,M(t,e))?d(t,e):d(t,e,r),set:(t,e,r,i)=>ee(e)&&k(t,e)?C(t,e,de(r)):C(t,e,r,i),getOwnPropertyDescriptor(t,e){if(ee(e)&&k(t,e)){const r=p(t,e);return r.value=ye(r.value),r}return p(t,e)},defineProperty:(t,e,r)=>ee(e)&&k(t,e)&&k(r,"value")?(r.value=de(r.value),g(t,e,r)):g(t,e,r)});class Ge{constructor(t,e,r){let n;if(De(t))n=u(At,[_e(t)],new.target);else if(Kt(t)&&!Qt(t)){let e,r;if(qt(t)){e=t,r=wt(t);if(be(pt(t)))throw Rt(i);if(Jt(t))throw Rt(s);const o=new K(2*r);n=u(At,[o],new.target)}else{const i=t[E];if(null!=i&&"function"!=typeof i)throw Rt(o);null!=i?te(t)?(e=t,r=t.length):(e=[...t],r=e.length):(e=t,r=Ae(e.length)),n=u(At,[r],new.target)}for(let t=0;t<r;++t)n[t]=de(e[t])}else n=u(At,arguments,new.target);const a=new I(n,Re);return Vt(Se,a,n),a}static from(t,...r){const i=this;if(!w(i,re))throw Rt(e);if(i===Ge){if(De(t)&&0===r.length){const e=_e(t),r=new At(pt(e),mt(e),wt(e));return new Ge(pt(gt(r)))}if(0===r.length)return new Ge(pt(It(t,de)));const e=r[0],i=r[1];return new Ge(pt(It(t,(function(t,...r){return de(f(e,this,[t,...Zt(r)]))}),i)))}let s,a;const l=t[E];if(null!=l&&"function"!=typeof l)throw Rt(o);if(null!=l)te(t)?(s=t,a=t.length):qt(h=t)&&h[E]===nt&&St.next===Dt?(s=t,a=wt(t)):(s=[...t],a=s.length);else{if(null==t)throw Rt(n);s=B(t),a=Ae(s.length)}var h;const c=new i(a);if(0===r.length)for(let t=0;t<a;++t)c[t]=s[t];else{const t=r[0],e=r[1];for(let r=0;r<a;++r)c[r]=f(t,e,[s[r],r])}return c}static of(...t){const r=this;if(!w(r,re))throw Rt(e);const i=t.length;if(r===Ge){const e=new Ge(i),r=_e(e);for(let e=0;e<i;++e)r[e]=de(t[e]);return e}const n=new r(i);for(let e=0;e<i;++e)n[e]=t[e];return n}keys(){Ee(this);const t=_e(this);return st(t)}values(){Ee(this);const t=_e(this);return Yt(function*(){for(const e of ot(t))yield ye(e)}())}entries(){Ee(this);const t=_e(this);return Yt(function*(){for(const[e,r]of at(t))yield[e,ye(r)]}())}at(t){Ee(this);const e=_e(this),r=wt(e),i=Ce(t),n=i>=0?i:r+i;if(!(n<0||n>=r))return ye(e[n])}with(t,e){Ee(this);const r=_e(this),i=wt(r),n=Ce(t),s=n>=0?n:i+n,o=+e;if(s<0||s>=i)throw Gt(l);const a=new At(pt(r),mt(r),wt(r)),h=new Ge(pt(gt(a)));return _e(h)[s]=de(o),h}map(t,...e){Ee(this);const r=_e(this),i=wt(r),n=e[0],s=Ie(r,Ge);if(s===Ge){const e=new Ge(i),s=_e(e);for(let e=0;e<i;++e){const i=ye(r[e]);s[e]=de(f(t,n,[i,e,this]))}return e}const o=new s(i);xe(o,i);for(let e=0;e<i;++e){const i=ye(r[e]);o[e]=f(t,n,[i,e,this])}return o}filter(t,...e){Ee(this);const r=_e(this),i=wt(r),n=e[0],s=[];for(let e=0;e<i;++e){const i=ye(r[e]);f(t,n,[i,e,this])&&j(s,i)}const o=new(Ie(r,Ge))(s);return xe(o),o}reduce(t,...e){Ee(this);const r=_e(this),i=wt(r);if(0===i&&0===e.length)throw Rt(a);let n,s;0===e.length?(n=ye(r[0]),s=1):(n=e[0],s=0);for(let e=s;e<i;++e)n=t(n,ye(r[e]),e,this);return n}reduceRight(t,...e){Ee(this);const r=_e(this),i=wt(r);if(0===i&&0===e.length)throw Rt(a);let n,s;0===e.length?(n=ye(r[i-1]),s=i-2):(n=e[0],s=i-1);for(let e=s;e>=0;--e)n=t(n,ye(r[e]),e,this);return n}forEach(t,...e){Ee(this);const r=_e(this),i=wt(r),n=e[0];for(let e=0;e<i;++e)f(t,n,[ye(r[e]),e,this])}find(t,...e){Ee(this);const r=_e(this),i=wt(r),n=e[0];for(let e=0;e<i;++e){const i=ye(r[e]);if(f(t,n,[i,e,this]))return i}}findIndex(t,...e){Ee(this);const r=_e(this),i=wt(r),n=e[0];for(let e=0;e<i;++e){const i=ye(r[e]);if(f(t,n,[i,e,this]))return e}return-1}findLast(t,...e){Ee(this);const r=_e(this),i=wt(r),n=e[0];for(let e=i-1;e>=0;--e){const i=ye(r[e]);if(f(t,n,[i,e,this]))return i}}findLastIndex(t,...e){Ee(this);const r=_e(this),i=wt(r),n=e[0];for(let e=i-1;e>=0;--e){const i=ye(r[e]);if(f(t,n,[i,e,this]))return e}return-1}every(t,...e){Ee(this);const r=_e(this),i=wt(r),n=e[0];for(let e=0;e<i;++e)if(!f(t,n,[ye(r[e]),e,this]))return!1;return!0}some(t,...e){Ee(this);const r=_e(this),i=wt(r),n=e[0];for(let e=0;e<i;++e)if(f(t,n,[ye(r[e]),e,this]))return!0;return!1}set(t,...e){Ee(this);const r=_e(this),o=Ce(e[0]);if(o<0)throw Gt(l);if(null==t)throw Rt(n);if(Jt(t))throw Rt(s);if(De(t))return lt(_e(this),_e(t),o);if(qt(t)){if(be(pt(t)))throw Rt(i)}const a=wt(r),h=B(t),c=Ae(h.length);if(o===1/0||c+o>a)throw Gt(l);for(let t=0;t<c;++t)r[t+o]=de(h[t])}reverse(){Ee(this);const t=_e(this);return ht(t),this}toReversed(){Ee(this);const t=_e(this),e=new At(pt(t),mt(t),wt(t)),r=new Ge(pt(gt(e))),i=_e(r);return ht(i),r}fill(t,...e){Ee(this);const r=_e(this);return ct(r,de(t),...Zt(e)),this}copyWithin(t,e,...r){Ee(this);const i=_e(this);return ft(i,t,e,...Zt(r)),this}sort(t){Ee(this);const e=_e(this),r=void 0!==t?t:ve;return ut(e,((t,e)=>r(ye(t),ye(e)))),this}toSorted(t){Ee(this);const e=_e(this);if(void 0!==t&&"function"!=typeof t)throw new Rt("The comparison function must be either a function or undefined");const r=void 0!==t?t:ve,i=new At(pt(e),mt(e),wt(e)),n=new Ge(pt(gt(i))),s=_e(n);return ut(s,((t,e)=>r(ye(t),ye(e)))),n}slice(t,e){Ee(this);const r=_e(this),n=Ie(r,Ge);if(n===Ge){const i=new At(pt(r),mt(r),wt(r));return new Ge(pt(gt(i,t,e)))}const s=wt(r),o=Ce(t),a=void 0===e?s:Ce(e);let l,h;l=o===-1/0?0:o<0?s+o>0?s+o:0:s<o?s:o,h=a===-1/0?0:a<0?s+a>0?s+a:0:s<a?s:a;const c=h-l>0?h-l:0,f=new n(c);if(xe(f,c),0===c)return f;if(be(pt(r)))throw Rt(i);let u=0;for(;l<h;)f[u]=ye(r[l]),++l,++u;return f}subarray(t,e){Ee(this);const r=_e(this),i=Ie(r,Ge),n=new At(pt(r),mt(r),wt(r)),s=dt(n,t,e),o=new i(pt(s),mt(s),wt(s));return xe(o),o}indexOf(t,...e){Ee(this);const r=_e(this),i=wt(r);let n=Ce(e[0]);if(n===1/0)return-1;n<0&&(n+=i,n<0&&(n=0));for(let e=n;e<i;++e)if(k(r,e)&&ye(r[e])===t)return e;return-1}lastIndexOf(t,...e){Ee(this);const r=_e(this),i=wt(r);let n=e.length>=1?Ce(e[0]):i-1;if(n===-1/0)return-1;n>=0?n=n<i-1?n:i-1:n+=i;for(let e=n;e>=0;--e)if(k(r,e)&&ye(r[e])===t)return e;return-1}includes(t,...e){Ee(this);const r=_e(this),i=wt(r);let n=Ce(e[0]);if(n===1/0)return!1;n<0&&(n+=i,n<0&&(n=0));const s=D(t);for(let e=n;e<i;++e){const i=ye(r[e]);if(s&&D(i))return!0;if(i===t)return!0}return!1}join(t){Ee(this);const e=Te(_e(this));return V(e,t)}toLocaleString(...t){Ee(this);const e=Te(_e(this));return H(e,...Zt(t))}get[_](){if(De(this))return"Float16Array"}}G(Ge,"BYTES_PER_ELEMENT",{value:2}),G(Ge,re,{}),A(Ge,et);const Fe=Ge.prototype;function Oe(t){return le(t)}G(Fe,"BYTES_PER_ELEMENT",{value:2}),G(Fe,E,{value:Fe.values,writable:!0,configurable:!0}),A(Fe,it),t.Float16Array=Ge,t.f16round=Oe,t.getFloat16=function(t,e,...r){return ye(Tt(t,e,...Zt(r)))},t.hfround=Oe,t.isFloat16Array=De,t.isTypedArray=function(t){return qt(t)||De(t)},t.setFloat16=function(t,e,r,...i){return Bt(t,e,de(r),...Zt(i))},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}({})},3657:function(t,e){function r(t,e,r){const i=r&&r.debug||!1;i&&console.log("[xml-utils] getting "+e+" in "+t);const n="object"==typeof t?t.outer:t,s=n.slice(0,n.indexOf(">")+1),o=['"',"'"];for(let t=0;t<o.length;t++){const r=o[t],n=e+"\\="+r+"([^"+r+"]*)"+r;i&&console.log("[xml-utils] pattern:",n);const a=new RegExp(n).exec(s);if(i&&console.log("[xml-utils] match:",a),a)return a[1]}}t.exports=r,t.exports.default=r},3658:function(t,e,r){const i=r(3659);function n(t,e,r){const n=[],s=r&&r.debug||!1,o=!r||"boolean"!=typeof r.nested||r.nested;let a,l=r&&r.startIndex||0;for(;a=i(t,e,{debug:s,startIndex:l});)l=o?a.start+1+e.length:a.end,n.push(a);return s&&console.log("findTagsByName found",n.length,"tags"),n}t.exports=n,t.exports.default=n},3659:function(t,e,r){const i=r(3660),n=r(3661),s=r(3662);function o(t,e,r){const o=r&&r.debug||!1,a=!(r&&!1===typeof r.nested),l=r&&r.startIndex||0;o&&console.log("[xml-utils] starting findTagByName with",e," and ",r);const h=i(t,`<${e}[ \n>/]`,l);if(o&&console.log("[xml-utils] start:",h),-1===h)return;const c=t.slice(h+e.length);let f=n(c,"^[^<]*[ /]>",0);const u=-1!==f&&"/"===c[f-1];if(o&&console.log("[xml-utils] selfClosing:",u),!1===u)if(a){let t=0,r=1,i=0;for(;-1!==(f=n(c,"[ /]"+e+">",t));){const n=c.substring(t,f+1);if(r+=s(n,"<"+e+"[ \n\t>]"),i+=s(n,"</"+e+">"),i>=r)break;t=f}}else f=n(c,"[ /]"+e+">",0);const g=h+e.length+f+1;if(o&&console.log("[xml-utils] end:",g),-1===g)return;const d=t.slice(h,g);let p;return p=u?null:d.slice(d.indexOf(">")+1,d.lastIndexOf("<")),{inner:p,outer:d,start:h,end:g}}t.exports=o,t.exports.default=o},3660:function(t,e){function r(t,e,r){const i=new RegExp(e).exec(t.slice(r));return i?r+i.index:-1}t.exports=r,t.exports.default=r},3661:function(t,e){function r(t,e,r){const i=new RegExp(e).exec(t.slice(r));return i?r+i.index+i[0].length-1:-1}t.exports=r,t.exports.default=r},3662:function(t,e){function r(t,e){const r=new RegExp(e,"g"),i=t.match(r);return i?i.length:0}t.exports=r,t.exports.default=r},3663:function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return u}));var i=r(3664),n=r.n(i),s=r(3665),o=r.n(s),a=r(3666),l=r.n(a),h=r(750),c=r(890);class f extends h.b{constructor(t,e){super(),this.response=t,this.dataPromise=e}get status(){return this.response.statusCode}getHeader(t){return this.response.headers[t]}async getData(){return await this.dataPromise}}class u extends h.a{constructor(t){super(t),this.parsedUrl=l.a.parse(this.url),this.httpApi="http:"===this.parsedUrl.protocol?n.a:o.a}constructRequest(e,r){return new Promise(((i,n)=>{const s=this.httpApi.get({...this.parsedUrl,headers:e},(e=>{const r=new Promise((r=>{const i=[];e.on("data",(t=>{i.push(t)})),e.on("end",(()=>{const e=t.concat(i).buffer;r(e)})),e.on("error",n)}));i(new f(e,r))}));s.on("error",n),r&&(r.aborted&&s.destroy(new c.a("Request aborted")),r.addEventListener("abort",(()=>s.destroy(new c.a("Request aborted")))))}))}async request({headers:t,signal:e}={}){return await this.constructRequest(t,e)}}}).call(this,r(347).Buffer)},3667:function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return a}));var i=r(3668),n=r.n(i),s=r(889);class o extends s.a{constructor(t){super(),this.path=t,this.openRequest=function(t,e,r){return new Promise(((i,s)=>{n.a.open(t,e,r,((t,e)=>{t?s(t):i(e)}))}))}(t,"r")}async fetchSlice(e){const r=await this.openRequest,{buffer:i}=await function(...t){return new Promise(((e,r)=>{n.a.read(...t,((t,i,n)=>{t?r(t):e({bytesRead:i,buffer:n})}))}))}(r,t.alloc(e.length),0,e.length,e.offset);return i.buffer}async close(){const t=await this.openRequest;await function(t){return new Promise(((e,r)=>{n.a.close(t,(t=>{t?r(t):e()}))}))}(t)}}function a(t){return new o(t)}}).call(this,r(347).Buffer)},3676:function(t,e,r){"use strict";r.r(e),r.d(e,"TIFFImageryProvider",(function(){return Ce})),r.d(e,"colorscales",(function(){return Et})),r.d(e,"default",(function(){return Ce})),r.d(e,"renderColorScaleToCanvas",(function(){return Mt}));var i=r(251),n=r.n(i),s=r(222),o=r.n(s),a=r(312),l=r.n(a),h=r(175),c=r.n(h),f=r(194),u=r.n(f),g=r(256),d=r.n(g),p=r(377),m=r.n(p),w=r(206),y=r.n(w),C=r(265),A=r.n(C),I=r(390),b=r.n(I),v=r(557),S=r.n(v);const D=new Map;function E(t,e){Array.isArray(t)||(t=[t]),t.forEach((t=>D.set(t,e)))}async function x(t){const e=D.get(t.Compression);if(!e)throw new Error(`Unknown compression method identifier: ${t.Compression}`);return new(await e())(t)}E([void 0,1],(()=>r.e(17).then(r.bind(null,3710)).then((t=>t.default)))),E(5,(()=>r.e(15).then(r.bind(null,3711)).then((t=>t.default)))),E(6,(()=>{throw new Error("old style JPEG compression is not supported.")})),E(7,(()=>r.e(14).then(r.bind(null,3712)).then((t=>t.default)))),E([8,32946],(()=>Promise.all([r.e(1),r.e(21)]).then(r.bind(null,3713)).then((t=>t.default)))),E(32773,(()=>r.e(16).then(r.bind(null,3714)).then((t=>t.default)))),E(34887,(()=>Promise.all([r.e(1),r.e(13)]).then(r.bind(null,3715)).then((async t=>(await t.zstd.init(),t))).then((t=>t.default)))),E(50001,(()=>r.e(18).then(r.bind(null,3716)).then((t=>t.default))));const _="undefined"!=typeof navigator&&navigator.hardwareConcurrency||2;var T=class{constructor(t=_,e){this.workers=null,this._awaitingDecoder=null,this.size=t,this.messageId=0,t&&(this._awaitingDecoder=e?Promise.resolve(e):new Promise((t=>{r.e(19).then(r.bind(null,3709)).then((e=>{t(e.create)}))})),this._awaitingDecoder.then((e=>{this._awaitingDecoder=null,this.workers=[];for(let r=0;r<t;r++)this.workers.push({worker:e(),idle:!0})})))}async decode(t,e){return this._awaitingDecoder&&await this._awaitingDecoder,0===this.size?x(t).then((r=>r.decode(t,e))):new Promise((r=>{const i=this.workers.find((t=>t.idle))||this.workers[Math.floor(Math.random()*this.size)];i.idle=!1;const n=this.messageId++,s=t=>{t.data.id===n&&(i.idle=!0,r(t.data.decoded),i.worker.removeEventListener("message",s))};i.worker.addEventListener("message",s),i.worker.postMessage({fileDirectory:t,buffer:e,id:n},[e])}))}destroy(){this.workers&&(this.workers.forEach((t=>{t.worker.terminate()})),this.workers=null)}},B=r(2446),R=r(3657),G=r.n(R),F=r(3658),O=r.n(F),P=r(749);function M(t,e,r,i=1){return new(Object.getPrototypeOf(t).constructor)(e*r*i)}function k(t,e,r){return(1-r)*t+r*e}function U(t,e,r,i,n,s="nearest"){switch(s.toLowerCase()){case"nearest":return function(t,e,r,i,n){const s=e/i,o=r/n;return t.map((t=>{const a=M(t,i,n);for(let l=0;l<n;++l){const n=Math.min(Math.round(o*l),r-1);for(let r=0;r<i;++r){const o=Math.min(Math.round(s*r),e-1),h=t[n*e+o];a[l*i+r]=h}}return a}))}(t,e,r,i,n);case"bilinear":case"linear":return function(t,e,r,i,n){const s=e/i,o=r/n;return t.map((t=>{const a=M(t,i,n);for(let l=0;l<n;++l){const n=o*l,h=Math.floor(n),c=Math.min(Math.ceil(n),r-1);for(let r=0;r<i;++r){const o=s*r,f=o%1,u=Math.floor(o),g=Math.min(Math.ceil(o),e-1),d=t[h*e+u],p=t[h*e+g],m=t[c*e+u],w=t[c*e+g],y=k(k(d,p,f),k(m,w,f),n%1);a[l*i+r]=y}}return a}))}(t,e,r,i,n);default:throw new Error(`Unsupported resampling method: '${s}'`)}}function L(t,e,r,i,n,s,o="nearest"){switch(o.toLowerCase()){case"nearest":return function(t,e,r,i,n,s){const o=e/i,a=r/n,l=M(t,i,n,s);for(let h=0;h<n;++h){const n=Math.min(Math.round(a*h),r-1);for(let r=0;r<i;++r){const a=Math.min(Math.round(o*r),e-1);for(let o=0;o<s;++o){const c=t[n*e*s+a*s+o];l[h*i*s+r*s+o]=c}}}return l}(t,e,r,i,n,s);case"bilinear":case"linear":return function(t,e,r,i,n,s){const o=e/i,a=r/n,l=M(t,i,n,s);for(let h=0;h<n;++h){const n=a*h,c=Math.floor(n),f=Math.min(Math.ceil(n),r-1);for(let r=0;r<i;++r){const a=o*r,u=a%1,g=Math.floor(a),d=Math.min(Math.ceil(a),e-1);for(let o=0;o<s;++o){const a=t[c*e*s+g*s+o],p=t[c*e*s+d*s+o],m=t[f*e*s+g*s+o],w=t[f*e*s+d*s+o],y=k(k(a,p,u),k(m,w,u),n%1);l[h*i*s+r*s+o]=y}}}return l}(t,e,r,i,n,s);default:throw new Error(`Unsupported resampling method: '${o}'`)}}function N(t,e,r){let i=0;for(let n=e;n<r;++n)i+=t[n];return i}function V(t,e,r){switch(t){case 1:if(e<=8)return new Uint8Array(r);if(e<=16)return new Uint16Array(r);if(e<=32)return new Uint32Array(r);break;case 2:if(8===e)return new Int8Array(r);if(16===e)return new Int16Array(r);if(32===e)return new Int32Array(r);break;case 3:switch(e){case 16:case 32:return new Float32Array(r);case 64:return new Float64Array(r)}}throw Error("Unsupported data format/bitsPerSample")}var j=class{constructor(t,e,r,i,n,s){this.fileDirectory=t,this.geoKeys=e,this.dataView=r,this.littleEndian=i,this.tiles=n?{}:null,this.isTiled=!t.StripOffsets;const o=t.PlanarConfiguration;if(this.planarConfiguration=void 0===o?1:o,1!==this.planarConfiguration&&2!==this.planarConfiguration)throw new Error("Invalid planar configuration.");this.source=s}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return void 0!==this.fileDirectory.SamplesPerPixel?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:void 0!==this.fileDirectory.RowsPerStrip?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(t){return this.isTiled||(t+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-t*this.getTileHeight()}getBytesPerPixel(){let t=0;for(let e=0;e<this.fileDirectory.BitsPerSample.length;++e)t+=this.getSampleByteSize(e);return t}getSampleByteSize(t){if(t>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${t} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[t]/8)}getReaderForSample(t){const e=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1,r=this.fileDirectory.BitsPerSample[t];switch(e){case 1:if(r<=8)return DataView.prototype.getUint8;if(r<=16)return DataView.prototype.getUint16;if(r<=32)return DataView.prototype.getUint32;break;case 2:if(r<=8)return DataView.prototype.getInt8;if(r<=16)return DataView.prototype.getInt16;if(r<=32)return DataView.prototype.getInt32;break;case 3:switch(r){case 16:return function(t,e){return Object(B.getFloat16)(this,t,e)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(t=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1}getBitsPerSample(t=0){return this.fileDirectory.BitsPerSample[t]}getArrayForSample(t,e){return V(this.getSampleFormat(t),this.getBitsPerSample(t),e)}async getTileOrStrip(t,e,r,i,n){const s=Math.ceil(this.getWidth()/this.getTileWidth()),o=Math.ceil(this.getHeight()/this.getTileHeight());let a;const{tiles:l}=this;let h,c;1===this.planarConfiguration?a=e*s+t:2===this.planarConfiguration&&(a=r*s*o+e*s+t),this.isTiled?(h=this.fileDirectory.TileOffsets[a],c=this.fileDirectory.TileByteCounts[a]):(h=this.fileDirectory.StripOffsets[a],c=this.fileDirectory.StripByteCounts[a]);const f=(await this.source.fetch([{offset:h,length:c}],n))[0];let u;return null!==l&&l[a]?u=l[a]:(u=(async()=>{let t=await i.decode(this.fileDirectory,f);const r=this.getSampleFormat(),n=this.getBitsPerSample();return function(t,e){return(1!==t&&2!==t||!(e<=32)||e%8!=0)&&(3!==t||16!==e&&32!==e&&64!==e)}(r,n)&&(t=function(t,e,r,i,n,s,o){const a=new DataView(t),l=2===r?1:i,h=V(e,n,2===r?o*s:o*s*i),c=parseInt("1".repeat(n),2);if(1===e){let t;t=1===r?i*n:n;let e=s*t;7&e&&(e=e+7&-8);for(let t=0;t<o;++t){const r=t*e;for(let e=0;e<s;++e){const i=r+e*l*n;for(let r=0;r<l;++r){const o=i+r*n,f=(t*s+e)*l+r,u=Math.floor(o/8),g=o%8;if(g+n<=8)h[f]=a.getUint8(u)>>8-n-g&c;else if(g+n<=16)h[f]=a.getUint16(u)>>16-n-g&c;else if(g+n<=24){const t=a.getUint16(u)<<8|a.getUint8(u+2);h[f]=t>>24-n-g&c}else h[f]=a.getUint32(u)>>32-n-g&c}}}}return h.buffer}(t,r,this.planarConfiguration,this.getSamplesPerPixel(),n,this.getTileWidth(),this.getBlockHeight(e))),t})(),null!==l&&(l[a]=u)),{x:t,y:e,sample:r,data:await u}}async _readRaster(t,e,r,i,n,s,o,a,l){const h=this.getTileWidth(),c=this.getTileHeight(),f=this.getWidth(),u=this.getHeight(),g=Math.max(Math.floor(t[0]/h),0),d=Math.min(Math.ceil(t[2]/h),Math.ceil(f/h)),p=Math.max(Math.floor(t[1]/c),0),m=Math.min(Math.ceil(t[3]/c),Math.ceil(u/c)),w=t[2]-t[0];let y=this.getBytesPerPixel();const C=[],A=[];for(let t=0;t<e.length;++t)1===this.planarConfiguration?C.push(N(this.fileDirectory.BitsPerSample,0,e[t])/8):C.push(0),A.push(this.getReaderForSample(e[t]));const I=[],{littleEndian:b}=this;for(let s=p;s<m;++s)for(let o=g;o<d;++o){let a;1===this.planarConfiguration&&(a=this.getTileOrStrip(o,s,0,n,l));for(let g=0;g<e.length;++g){const d=g,p=e[g];2===this.planarConfiguration&&(y=this.getSampleByteSize(p),a=this.getTileOrStrip(o,s,p,n,l));const m=a.then((n=>{const s=n.data,o=new DataView(s),a=this.getBlockHeight(n.y),l=n.y*c,g=n.x*h,p=l+a,m=(n.x+1)*h,I=A[d],v=Math.min(a,a-(p-t[3]),u-l),S=Math.min(h,h-(m-t[2]),f-g);for(let n=Math.max(0,t[1]-l);n<v;++n)for(let s=Math.max(0,t[0]-g);s<S;++s){const a=(n*h+s)*y,c=I.call(o,a+C[d],b);let f;i?(f=(n+l-t[1])*w*e.length+(s+g-t[0])*e.length+d,r[f]=c):(f=(n+l-t[1])*w+s+g-t[0],r[d][f]=c)}}));I.push(m)}}if(await Promise.all(I),s&&t[2]-t[0]!==s||o&&t[3]-t[1]!==o){let n;return n=i?L(r,t[2]-t[0],t[3]-t[1],s,o,e.length,a):U(r,t[2]-t[0],t[3]-t[1],s,o,a),n.width=s,n.height=o,n}return r.width=s||t[2]-t[0],r.height=o||t[3]-t[1],r}async readRasters({window:t,samples:e=[],interleave:r,pool:i=null,width:n,height:s,resampleMethod:o,fillValue:a,signal:l}={}){const h=t||[0,0,this.getWidth(),this.getHeight()];if(h[0]>h[2]||h[1]>h[3])throw new Error("Invalid subsets");const c=(h[2]-h[0])*(h[3]-h[1]),f=this.getSamplesPerPixel();if(e&&e.length){for(let t=0;t<e.length;++t)if(e[t]>=f)return Promise.reject(new RangeError(`Invalid sample index '${e[t]}'.`))}else for(let t=0;t<f;++t)e.push(t);let u;if(r){u=V(this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,Math.max.apply(null,this.fileDirectory.BitsPerSample),c*e.length),a&&u.fill(a)}else{u=[];for(let t=0;t<e.length;++t){const r=this.getArrayForSample(e[t],c);Array.isArray(a)&&t<a.length?r.fill(a[t]):a&&!Array.isArray(a)&&r.fill(a),u.push(r)}}const g=i||await x(this.fileDirectory);return await this._readRaster(h,e,u,r,g,n,s,o,l)}async readRGB({window:t,interleave:e=!0,pool:r=null,width:i,height:n,resampleMethod:s,enableAlpha:o=!1,signal:a}={}){const l=t||[0,0,this.getWidth(),this.getHeight()];if(l[0]>l[2]||l[1]>l[3])throw new Error("Invalid subsets");const h=this.fileDirectory.PhotometricInterpretation;if(h===P.j.RGB){let l=[0,1,2];if(this.fileDirectory.ExtraSamples!==P.a.Unspecified&&o){l=[];for(let t=0;t<this.fileDirectory.BitsPerSample.length;t+=1)l.push(t)}return this.readRasters({window:t,interleave:e,samples:l,pool:r,width:i,height:n,resampleMethod:s,signal:a})}let c;switch(h){case P.j.WhiteIsZero:case P.j.BlackIsZero:case P.j.Palette:c=[0];break;case P.j.CMYK:c=[0,1,2,3];break;case P.j.YCbCr:case P.j.CIELab:c=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const f={window:l,interleave:!0,samples:c,pool:r,width:i,height:n,resampleMethod:s,signal:a},{fileDirectory:u}=this,g=await this.readRasters(f),d=2**this.fileDirectory.BitsPerSample[0];let p;switch(h){case P.j.WhiteIsZero:p=function(t,e){const{width:r,height:i}=t,n=new Uint8Array(r*i*3);let s;for(let r=0,i=0;r<t.length;++r,i+=3)s=256-t[r]/e*256,n[i]=s,n[i+1]=s,n[i+2]=s;return n}(g,d);break;case P.j.BlackIsZero:p=function(t,e){const{width:r,height:i}=t,n=new Uint8Array(r*i*3);let s;for(let r=0,i=0;r<t.length;++r,i+=3)s=t[r]/e*256,n[i]=s,n[i+1]=s,n[i+2]=s;return n}(g,d);break;case P.j.Palette:p=function(t,e){const{width:r,height:i}=t,n=new Uint8Array(r*i*3),s=e.length/3,o=e.length/3*2;for(let r=0,i=0;r<t.length;++r,i+=3){const a=t[r];n[i]=e[a]/65536*256,n[i+1]=e[a+s]/65536*256,n[i+2]=e[a+o]/65536*256}return n}(g,u.ColorMap);break;case P.j.CMYK:p=function(t){const{width:e,height:r}=t,i=new Uint8Array(e*r*3);for(let e=0,r=0;e<t.length;e+=4,r+=3){const n=t[e],s=t[e+1],o=t[e+2],a=t[e+3];i[r]=(255-n)/256*255*((255-a)/256),i[r+1]=(255-s)/256*255*((255-a)/256),i[r+2]=(255-o)/256*255*((255-a)/256)}return i}(g);break;case P.j.YCbCr:p=function(t){const{width:e,height:r}=t,i=new Uint8ClampedArray(e*r*3);for(let e=0,r=0;e<t.length;e+=3,r+=3){const n=t[e],s=t[e+1],o=t[e+2];i[r]=n+1.402*(o-128),i[r+1]=n-.34414*(s-128)-.71414*(o-128),i[r+2]=n+1.772*(s-128)}return i}(g);break;case P.j.CIELab:p=function(t){const{width:e,height:r}=t,i=new Uint8Array(e*r*3);for(let e=0,r=0;e<t.length;e+=3,r+=3){let n,s,o,a=(t[e+0]+16)/116,l=(t[e+1]<<24>>24)/500+a,h=a-(t[e+2]<<24>>24)/200;l=.95047*(l*l*l>.008856?l*l*l:(l-16/116)/7.787),a=1*(a*a*a>.008856?a*a*a:(a-16/116)/7.787),h=1.08883*(h*h*h>.008856?h*h*h:(h-16/116)/7.787),n=3.2406*l+-1.5372*a+-.4986*h,s=-.9689*l+1.8758*a+.0415*h,o=.0557*l+-.204*a+1.057*h,n=n>.0031308?1.055*n**(1/2.4)-.055:12.92*n,s=s>.0031308?1.055*s**(1/2.4)-.055:12.92*s,o=o>.0031308?1.055*o**(1/2.4)-.055:12.92*o,i[r]=255*Math.max(0,Math.min(1,n)),i[r+1]=255*Math.max(0,Math.min(1,s)),i[r+2]=255*Math.max(0,Math.min(1,o))}return i}(g);break;default:throw new Error("Unsupported photometric interpretation.")}if(!e){const t=new Uint8Array(p.length/3),e=new Uint8Array(p.length/3),r=new Uint8Array(p.length/3);for(let i=0,n=0;i<p.length;i+=3,++n)t[n]=p[i],e[n]=p[i+1],r[n]=p[i+2];p=[t,e,r]}return p.width=g.width,p.height=g.height,p}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const t=[];for(let e=0;e<this.fileDirectory.ModelTiepoint.length;e+=6)t.push({i:this.fileDirectory.ModelTiepoint[e],j:this.fileDirectory.ModelTiepoint[e+1],k:this.fileDirectory.ModelTiepoint[e+2],x:this.fileDirectory.ModelTiepoint[e+3],y:this.fileDirectory.ModelTiepoint[e+4],z:this.fileDirectory.ModelTiepoint[e+5]});return t}getGDALMetadata(t=null){const e={};if(!this.fileDirectory.GDAL_METADATA)return null;const r=this.fileDirectory.GDAL_METADATA;let i=O()(r,"Item");i=null===t?i.filter((t=>void 0===G()(t,"sample"))):i.filter((e=>Number(G()(e,"sample"))===t));for(let t=0;t<i.length;++t){const r=i[t];e[G()(r,"name")]=r.inner}return e}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const t=this.fileDirectory.GDAL_NODATA;return Number(t.substring(0,t.length-1))}getOrigin(){const t=this.fileDirectory.ModelTiepoint,e=this.fileDirectory.ModelTransformation;if(t&&6===t.length)return[t[3],t[4],t[5]];if(e)return[e[3],e[7],e[11]];throw new Error("The image does not have an affine transformation.")}getResolution(t=null){const e=this.fileDirectory.ModelPixelScale,r=this.fileDirectory.ModelTransformation;if(e)return[e[0],-e[1],e[2]];if(r)return 0===r[1]&&0===r[4]?[r[0],-r[5],r[10]]:[Math.sqrt(r[0]*r[0]+r[4]*r[4]),-Math.sqrt(r[1]*r[1]+r[5]*r[5]),r[10]];if(t){const[e,r,i]=t.getResolution();return[e*t.getWidth()/this.getWidth(),r*t.getHeight()/this.getHeight(),i*t.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return 1===this.geoKeys.GTRasterTypeGeoKey}getBoundingBox(t=!1){const e=this.getHeight(),r=this.getWidth();if(this.fileDirectory.ModelTransformation&&!t){const[t,i,n,s,o,a,l,h]=this.fileDirectory.ModelTransformation,c=[[0,0],[0,e],[r,0],[r,e]].map((([e,r])=>[s+t*e+i*r,h+o*e+a*r])),f=c.map((t=>t[0])),u=c.map((t=>t[1]));return[Math.min(...f),Math.min(...u),Math.max(...f),Math.max(...u)]}{const t=this.getOrigin(),i=this.getResolution(),n=t[0],s=t[1],o=n+i[0]*r,a=s+i[1]*e;return[Math.min(n,o),Math.min(s,a),Math.max(n,o),Math.max(s,a)]}}};class H{constructor(t){this._dataView=new DataView(t)}get buffer(){return this._dataView.buffer}getUint64(t,e){const r=this.getUint32(t,e),i=this.getUint32(t+4,e);let n;if(e){if(n=r+2**32*i,!Number.isSafeInteger(n))throw new Error(`${n} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return n}if(n=2**32*r+i,!Number.isSafeInteger(n))throw new Error(`${n} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return n}getInt64(t,e){let r=0;const i=(128&this._dataView.getUint8(t+(e?7:0)))>0;let n=!0;for(let s=0;s<8;s++){let o=this._dataView.getUint8(t+(e?s:7-s));i&&(n?0!==o&&(o=255&~(o-1),n=!1):o=255&~o),r+=o*256**s}return i&&(r=-r),r}getUint8(t,e){return this._dataView.getUint8(t,e)}getInt8(t,e){return this._dataView.getInt8(t,e)}getUint16(t,e){return this._dataView.getUint16(t,e)}getInt16(t,e){return this._dataView.getInt16(t,e)}getUint32(t,e){return this._dataView.getUint32(t,e)}getInt32(t,e){return this._dataView.getInt32(t,e)}getFloat16(t,e){return Object(B.getFloat16)(this._dataView,t,e)}getFloat32(t,e){return this._dataView.getFloat32(t,e)}getFloat64(t,e){return this._dataView.getFloat64(t,e)}}class Z{constructor(t,e,r,i){this._dataView=new DataView(t),this._sliceOffset=e,this._littleEndian=r,this._bigTiff=i}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(t,e){return this.sliceOffset<=t&&this.sliceTop>=t+e}readUint8(t){return this._dataView.getUint8(t-this._sliceOffset,this._littleEndian)}readInt8(t){return this._dataView.getInt8(t-this._sliceOffset,this._littleEndian)}readUint16(t){return this._dataView.getUint16(t-this._sliceOffset,this._littleEndian)}readInt16(t){return this._dataView.getInt16(t-this._sliceOffset,this._littleEndian)}readUint32(t){return this._dataView.getUint32(t-this._sliceOffset,this._littleEndian)}readInt32(t){return this._dataView.getInt32(t-this._sliceOffset,this._littleEndian)}readFloat32(t){return this._dataView.getFloat32(t-this._sliceOffset,this._littleEndian)}readFloat64(t){return this._dataView.getFloat64(t-this._sliceOffset,this._littleEndian)}readUint64(t){const e=this.readUint32(t),r=this.readUint32(t+4);let i;if(this._littleEndian){if(i=e+2**32*r,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}if(i=2**32*e+r,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}readInt64(t){let e=0;const r=(128&this._dataView.getUint8(t+(this._littleEndian?7:0)))>0;let i=!0;for(let n=0;n<8;n++){let s=this._dataView.getUint8(t+(this._littleEndian?n:7-n));r&&(i?0!==s&&(s=255&~(s-1),i=!1):s=255&~s),e+=s*256**n}return r&&(e=-e),e}readOffset(t){return this._bigTiff?this.readUint64(t):this.readUint32(t)}}const W="\r\n\r\n";function X(t){if(void 0!==Object.fromEntries)return Object.fromEntries(t);const e={};for(const[r,i]of t)e[r.toLowerCase()]=i;return e}function Y(t){return X(t.split("\r\n").map((t=>{const e=t.split(":").map((t=>t.trim()));return e[0]=e[0].toLowerCase(),e})))}function K(t){let e,r,i;return t&&([,e,r,i]=t.match(/bytes (\d+)-(\d+)\/(\d+)/),e=parseInt(e,10),r=parseInt(r,10),i=parseInt(i,10)),{start:e,end:r,total:i}}var z=r(889);class q extends Map{constructor(t={}){if(super(),!(t.maxSize&&t.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"==typeof t.maxAge&&0===t.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=t.maxSize,this.maxAge=t.maxAge||Number.POSITIVE_INFINITY,this.onEviction=t.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(t){if("function"==typeof this.onEviction)for(const[e,r]of t)this.onEviction(e,r.value)}_deleteIfExpired(t,e){return"number"==typeof e.expiry&&e.expiry<=Date.now()&&("function"==typeof this.onEviction&&this.onEviction(t,e.value),this.delete(t))}_getOrDeleteIfExpired(t,e){if(!1===this._deleteIfExpired(t,e))return e.value}_getItemValue(t,e){return e.expiry?this._getOrDeleteIfExpired(t,e):e.value}_peek(t,e){const r=e.get(t);return this._getItemValue(t,r)}_set(t,e){this.cache.set(t,e),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(t,e){this.oldCache.delete(t),this._set(t,e)}*_entriesAscending(){for(const t of this.oldCache){const[e,r]=t;if(!this.cache.has(e)){!1===this._deleteIfExpired(e,r)&&(yield t)}}for(const t of this.cache){const[e,r]=t;!1===this._deleteIfExpired(e,r)&&(yield t)}}get(t){if(this.cache.has(t)){const e=this.cache.get(t);return this._getItemValue(t,e)}if(this.oldCache.has(t)){const e=this.oldCache.get(t);if(!1===this._deleteIfExpired(t,e))return this._moveToRecent(t,e),e.value}}set(t,e,{maxAge:r=this.maxAge}={}){const i="number"==typeof r&&r!==Number.POSITIVE_INFINITY?Date.now()+r:void 0;return this.cache.has(t)?this.cache.set(t,{value:e,expiry:i}):this._set(t,{value:e,expiry:i}),this}has(t){return this.cache.has(t)?!this._deleteIfExpired(t,this.cache.get(t)):!!this.oldCache.has(t)&&!this._deleteIfExpired(t,this.oldCache.get(t))}peek(t){return this.cache.has(t)?this._peek(t,this.cache):this.oldCache.has(t)?this._peek(t,this.oldCache):void 0}delete(t){const e=this.cache.delete(t);return e&&this._size--,this.oldCache.delete(t)||e}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(t){if(!(t&&t>0))throw new TypeError("`maxSize` must be a number greater than 0");const e=[...this._entriesAscending()],r=e.length-t;r<0?(this.cache=new Map(e),this.oldCache=new Map,this._size=e.length):(r>0&&this._emitEvictions(e.slice(0,r)),this.oldCache=new Map(e.slice(r)),this.cache=new Map,this._size=0),this.maxSize=t}*keys(){for(const[t]of this)yield t}*values(){for(const[,t]of this)yield t}*[Symbol.iterator](){for(const t of this.cache){const[e,r]=t;!1===this._deleteIfExpired(e,r)&&(yield[e,r.value])}for(const t of this.oldCache){const[e,r]=t;if(!this.cache.has(e)){!1===this._deleteIfExpired(e,r)&&(yield[e,r.value])}}}*entriesDescending(){let t=[...this.cache];for(let e=t.length-1;e>=0;--e){const r=t[e],[i,n]=r;!1===this._deleteIfExpired(i,n)&&(yield[i,n.value])}t=[...this.oldCache];for(let e=t.length-1;e>=0;--e){const r=t[e],[i,n]=r;if(!this.cache.has(i)){!1===this._deleteIfExpired(i,n)&&(yield[i,n.value])}}}*entriesAscending(){for(const[t,e]of this._entriesAscending())yield[t,e.value]}get size(){if(!this._size)return this.oldCache.size;let t=0;for(const e of this.oldCache.keys())this.cache.has(e)||t++;return Math.min(this._size+t,this.maxSize)}entries(){return this.entriesAscending()}forEach(t,e=this){for(const[r,i]of this.entriesAscending())t.call(e,i,r,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}var J=r(890);class ${constructor(t,e,r=null){this.offset=t,this.length=e,this.data=r}get top(){return this.offset+this.length}}class Q{constructor(t,e,r){this.offset=t,this.length=e,this.blockIds=r}}class tt extends z.a{constructor(t,{blockSize:e=65536,cacheSize:r=100}={}){super(),this.source=t,this.blockSize=e,this.blockCache=new q({maxSize:r,onEviction:(t,e)=>{this.evictedBlocks.set(t,e)}}),this.evictedBlocks=new Map,this.blockRequests=new Map,this.blockIdsToFetch=new Set,this.abortedBlockIds=new Set}get fileSize(){return this.source.fileSize}async fetch(t,e){const r=[],i=[],n=[];this.evictedBlocks.clear();for(const{offset:e,length:s}of t){let t=e+s;const{fileSize:o}=this;null!==o&&(t=Math.min(t,o));for(let s=Math.floor(e/this.blockSize)*this.blockSize;s<t;s+=this.blockSize){const t=Math.floor(s/this.blockSize);this.blockCache.has(t)||this.blockRequests.has(t)||(this.blockIdsToFetch.add(t),i.push(t)),this.blockRequests.has(t)&&r.push(this.blockRequests.get(t)),n.push(t)}}await Object(J.h)(),this.fetchBlocks(e);const s=[];for(const t of i)this.blockRequests.has(t)&&s.push(this.blockRequests.get(t));await Promise.allSettled(r),await Promise.allSettled(s);const o=[],a=n.filter((t=>this.abortedBlockIds.has(t)||!this.blockCache.has(t)));if(a.forEach((t=>this.blockIdsToFetch.add(t))),a.length>0&&e&&!e.aborted){this.fetchBlocks(null);for(const t of a){const e=this.blockRequests.get(t);if(!e)throw new Error(`Block ${t} is not in the block requests`);o.push(e)}await Promise.allSettled(o)}if(e&&e.aborted)throw new J.a("Request was aborted");const l=n.map((t=>this.blockCache.get(t)||this.evictedBlocks.get(t))),h=l.filter((t=>!t));if(h.length)throw new J.b(h,"Request failed");const c=new Map(Object(J.i)(n,l));return this.readSliceData(t,c)}fetchBlocks(t){if(this.blockIdsToFetch.size>0){const e=this.groupBlocks(this.blockIdsToFetch),r=this.source.fetch(e,t);for(let i=0;i<e.length;++i){const n=e[i];for(const e of n.blockIds)this.blockRequests.set(e,(async()=>{try{const t=(await r)[i],n=e*this.blockSize,s=n-t.offset,o=Math.min(s+this.blockSize,t.data.byteLength),a=t.data.slice(s,o),l=new $(n,a.byteLength,a,e);this.blockCache.set(e,l),this.abortedBlockIds.delete(e)}catch(r){if("AbortError"!==r.name)throw r;r.signal=t,this.blockCache.delete(e),this.abortedBlockIds.add(e)}finally{this.blockRequests.delete(e)}})())}this.blockIdsToFetch.clear()}}groupBlocks(t){const e=Array.from(t).sort(((t,e)=>t-e));if(0===e.length)return[];let r=[],i=null;const n=[];for(const t of e)null===i||i+1===t?(r.push(t),i=t):(n.push(new Q(r[0]*this.blockSize,r.length*this.blockSize,r)),r=[t],i=t);return n.push(new Q(r[0]*this.blockSize,r.length*this.blockSize,r)),n}readSliceData(t,e){return t.map((t=>{let r=t.offset+t.length;null!==this.fileSize&&(r=Math.min(this.fileSize,r));const i=Math.floor(t.offset/this.blockSize),n=Math.floor(r/this.blockSize),s=new ArrayBuffer(t.length),o=new Uint8Array(s);for(let s=i;s<=n;++s){const i=e.get(s),n=i.offset-t.offset;let a,l=0,h=0;n<0?l=-n:n>0&&(h=n),a=i.top-r<0?i.length-l:r-i.offset-l;const c=new Uint8Array(i.data,l,a);o.set(c,h)}return s}))}}var et=r(750);class rt extends et.b{constructor(t){super(),this.response=t}get status(){return this.response.status}getHeader(t){return this.response.headers.get(t)}async getData(){return this.response.arrayBuffer?await this.response.arrayBuffer():(await this.response.buffer()).buffer}}class it extends et.a{constructor(t,e){super(t),this.credentials=e}async request({headers:t,signal:e}={}){const r=await fetch(this.url,{headers:t,credentials:this.credentials,signal:e});return new rt(r)}}class nt extends et.b{constructor(t,e){super(),this.xhr=t,this.data=e}get status(){return this.xhr.status}getHeader(t){return this.xhr.getResponseHeader(t)}async getData(){return this.data}}class st extends et.a{constructRequest(t,e){return new Promise(((r,i)=>{const n=new XMLHttpRequest;n.open("GET",this.url),n.responseType="arraybuffer";for(const[e,r]of Object.entries(t))n.setRequestHeader(e,r);n.onload=()=>{const t=n.response;r(new nt(n,t))},n.onerror=i,n.onabort=()=>i(new J.a("Request aborted")),n.send(),e&&(e.aborted&&n.abort(),e.addEventListener("abort",(()=>n.abort())))}))}async request({headers:t,signal:e}={}){return await this.constructRequest(t,e)}}var ot=r(3663);class at extends z.a{constructor(t,e,r,i){super(),this.client=t,this.headers=e,this.maxRanges=r,this.allowFullFile=i,this._fileSize=null}async fetch(t,e){return this.maxRanges>=t.length?this.fetchSlices(t,e):(this.maxRanges>0&&t.length,Promise.all(t.map((t=>this.fetchSlice(t,e)))))}async fetchSlices(t,e){const r=await this.client.request({headers:{...this.headers,Range:`bytes=${t.map((({offset:t,length:e})=>`${t}-${t+e}`)).join(",")}`},signal:e});if(r.ok){if(206===r.status){const{type:i,params:n}=function(t){const[e,...r]=t.split(";").map((t=>t.trim()));return{type:e,params:X(r.map((t=>t.split("="))))}}(r.getHeader("content-type"));if("multipart/byteranges"===i){const t=function(t,e){let r=null;const i=new TextDecoder("ascii"),n=[],s=`--${e}`,o=`${s}--`;for(let e=0;e<10;++e)i.decode(new Uint8Array(t,e,s.length))===s&&(r=e);if(null===r)throw new Error("Could not find initial boundary");for(;r<t.byteLength;){const e=i.decode(new Uint8Array(t,r,Math.min(s.length+1024,t.byteLength-r)));if(0===e.length||e.startsWith(o))break;if(!e.startsWith(s))throw new Error("Part does not start with boundary");const a=e.substr(s.length+2);if(0===a.length)break;const l=a.indexOf(W),h=Y(a.substr(0,l)),{start:c,end:f,total:u}=K(h["content-range"]),g=r+s.length+l+4,d=parseInt(f,10)+1-parseInt(c,10);n.push({headers:h,data:t.slice(g,g+d),offset:c,length:d,fileSize:u}),r=g+d+4}return n}(await r.getData(),n.boundary);return this._fileSize=t[0].fileSize||null,t}const s=await r.getData(),{start:o,end:a,total:l}=K(r.getHeader("content-range"));this._fileSize=l||null;const h=[{data:s,offset:o,length:a-o}];if(t.length>1){const r=await Promise.all(t.slice(1).map((t=>this.fetchSlice(t,e))));return h.concat(r)}return h}{if(!this.allowFullFile)throw new Error("Server responded with full file");const t=await r.getData();return this._fileSize=t.byteLength,[{data:t,offset:0,length:t.byteLength}]}}throw new Error("Error fetching data.")}async fetchSlice(t,e){const{offset:r,length:i}=t,n=await this.client.request({headers:{...this.headers,Range:`bytes=${r}-${r+i}`},signal:e});if(n.ok){if(206===n.status){const t=await n.getData(),{total:e}=K(n.getHeader("content-range"));return this._fileSize=e||null,{data:t,offset:r,length:i}}{if(!this.allowFullFile)throw new Error("Server responded with full file");const t=await n.getData();return this._fileSize=t.byteLength,{data:t,offset:0,length:t.byteLength}}}throw new Error("Error fetching data.")}get fileSize(){return this._fileSize}}function lt(t,{blockSize:e,cacheSize:r}){return null===e?t:new tt(t,{blockSize:e,cacheSize:r})}function ht(t,{forceXHR:e=!1,...r}={}){return"function"!=typeof fetch||e?"undefined"!=typeof XMLHttpRequest?function(t,{headers:e={},maxRanges:r=0,allowFullFile:i=!1,...n}={}){const s=new st(t);return lt(new at(s,e,r,i),n)}(t,r):function(t,{headers:e={},maxRanges:r=0,allowFullFile:i=!1,...n}={}){const s=new ot.a(t);return lt(new at(s,e,r,i),n)}(t,r):function(t,{headers:e={},credentials:r,maxRanges:i=0,allowFullFile:n=!1,...s}={}){const o=new it(t,r);return lt(new at(o,e,i,n),s)}(t,r)}z.a;class ct extends z.a{constructor(t){super(),this.file=t}async fetchSlice(t,e){return new Promise(((r,i)=>{const n=this.file.slice(t.offset,t.offset+t.length),s=new FileReader;s.onload=t=>r(t.target.result),s.onerror=i,s.onabort=i,s.readAsArrayBuffer(n),e&&e.addEventListener("abort",(()=>s.abort()))}))}}r(3667);const ft=Object(J.f)(P.e),ut=Object(J.f)(P.i),gt={};Object(J.c)(gt,ft),Object(J.c)(gt,ut);Object(J.f)(P.g);const dt={nextZero:(t,e)=>{let r=e;for(;0!==t[r];)r++;return r},readUshort:(t,e)=>t[e]<<8|t[e+1],readShort:(t,e)=>{const r=dt.ui8;return r[0]=t[e+1],r[1]=t[e+0],dt.i16[0]},readInt:(t,e)=>{const r=dt.ui8;return r[0]=t[e+3],r[1]=t[e+2],r[2]=t[e+1],r[3]=t[e+0],dt.i32[0]},readUint:(t,e)=>{const r=dt.ui8;return r[0]=t[e+3],r[1]=t[e+2],r[2]=t[e+1],r[3]=t[e+0],dt.ui32[0]},readASCII:(t,e,r)=>r.map((r=>String.fromCharCode(t[e+r]))).join(""),readFloat:(t,e)=>{const r=dt.ui8;return Object(J.g)(4,(i=>{r[i]=t[e+3-i]})),dt.fl32[0]},readDouble:(t,e)=>{const r=dt.ui8;return Object(J.g)(8,(i=>{r[i]=t[e+7-i]})),dt.fl64[0]},writeUshort:(t,e,r)=>{t[e]=r>>8&255,t[e+1]=255&r},writeUint:(t,e,r)=>{t[e]=r>>24&255,t[e+1]=r>>16&255,t[e+2]=r>>8&255,t[e+3]=255&r},writeASCII:(t,e,r)=>{Object(J.g)(r.length,(i=>{t[e+i]=r.charCodeAt(i)}))},ui8:new Uint8Array(8)};dt.fl64=new Float64Array(dt.ui8.buffer),dt.writeDouble=(t,e,r)=>{dt.fl64[0]=r,Object(J.g)(8,(r=>{t[e+r]=dt.ui8[7-r]}))};function pt(t){switch(t){case P.h.BYTE:case P.h.ASCII:case P.h.SBYTE:case P.h.UNDEFINED:return 1;case P.h.SHORT:case P.h.SSHORT:return 2;case P.h.LONG:case P.h.SLONG:case P.h.FLOAT:case P.h.IFD:return 4;case P.h.RATIONAL:case P.h.SRATIONAL:case P.h.DOUBLE:case P.h.LONG8:case P.h.SLONG8:case P.h.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${t}`)}}function mt(t,e,r,i){let n=null,s=null;const o=pt(e);switch(e){case P.h.BYTE:case P.h.ASCII:case P.h.UNDEFINED:n=new Uint8Array(r),s=t.readUint8;break;case P.h.SBYTE:n=new Int8Array(r),s=t.readInt8;break;case P.h.SHORT:n=new Uint16Array(r),s=t.readUint16;break;case P.h.SSHORT:n=new Int16Array(r),s=t.readInt16;break;case P.h.LONG:case P.h.IFD:n=new Uint32Array(r),s=t.readUint32;break;case P.h.SLONG:n=new Int32Array(r),s=t.readInt32;break;case P.h.LONG8:case P.h.IFD8:n=new Array(r),s=t.readUint64;break;case P.h.SLONG8:n=new Array(r),s=t.readInt64;break;case P.h.RATIONAL:n=new Uint32Array(2*r),s=t.readUint32;break;case P.h.SRATIONAL:n=new Int32Array(2*r),s=t.readInt32;break;case P.h.FLOAT:n=new Float32Array(r),s=t.readFloat32;break;case P.h.DOUBLE:n=new Float64Array(r),s=t.readFloat64;break;default:throw new RangeError(`Invalid field type: ${e}`)}if(e!==P.h.RATIONAL&&e!==P.h.SRATIONAL)for(let e=0;e<r;++e)n[e]=s.call(t,i+e*o);else for(let e=0;e<r;e+=2)n[e]=s.call(t,i+e*o),n[e+1]=s.call(t,i+(e*o+4));return e===P.h.ASCII?new TextDecoder("utf-8").decode(n):n}class wt{constructor(t,e,r){this.fileDirectory=t,this.geoKeyDirectory=e,this.nextIFDByteOffset=r}}class yt extends Error{constructor(t){super(`No image at index ${t}`),this.index=t}}class Ct{async readRasters(t={}){const{window:e,width:r,height:i}=t;let{resX:n,resY:s,bbox:o}=t;const a=await this.getImage();let l=a;const h=await this.getImageCount(),c=a.getBoundingBox();if(e&&o)throw new Error('Both "bbox" and "window" passed.');if(r||i){if(e){const[t,r]=a.getOrigin(),[i,n]=a.getResolution();o=[t+e[0]*i,r+e[1]*n,t+e[2]*i,r+e[3]*n]}const t=o||c;if(r){if(n)throw new Error("Both width and resX passed");n=(t[2]-t[0])/r}if(i){if(s)throw new Error("Both width and resY passed");s=(t[3]-t[1])/i}}if(n||s){const t=[];for(let e=0;e<h;++e){const r=await this.getImage(e),{SubfileType:i,NewSubfileType:n}=r.fileDirectory;(0===e||2===i||1&n)&&t.push(r)}t.sort(((t,e)=>t.getWidth()-e.getWidth()));for(let e=0;e<t.length;++e){const r=t[e],i=(c[2]-c[0])/r.getWidth(),o=(c[3]-c[1])/r.getHeight();if(l=r,n&&n>i||s&&s>o)break}}let f=e;if(o){const[t,e]=a.getOrigin(),[r,i]=l.getResolution(a);f=[Math.round((o[0]-t)/r),Math.round((o[1]-e)/i),Math.round((o[2]-t)/r),Math.round((o[3]-e)/i)],f=[Math.min(f[0],f[2]),Math.min(f[1],f[3]),Math.max(f[0],f[2]),Math.max(f[1],f[3])]}return l.readRasters({...t,window:f})}}class At extends Ct{constructor(t,e,r,i,n={}){super(),this.source=t,this.littleEndian=e,this.bigTiff=r,this.firstIFDOffset=i,this.cache=n.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(t,e){const r=this.bigTiff?4048:1024;return new Z((await this.source.fetch([{offset:t,length:void 0!==e?e:r}]))[0],t,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(t){const e=this.bigTiff?20:12,r=this.bigTiff?8:2;let i=await this.getSlice(t);const n=this.bigTiff?i.readUint64(t):i.readUint16(t),s=n*e+(this.bigTiff?16:6);i.covers(t,s)||(i=await this.getSlice(t,s));const o={};let a=t+(this.bigTiff?8:2);for(let t=0;t<n;a+=e,++t){const t=i.readUint16(a),e=i.readUint16(a+2),r=this.bigTiff?i.readUint64(a+4):i.readUint32(a+4);let n,s;const l=pt(e),h=a+(this.bigTiff?12:8);if(l*r<=(this.bigTiff?8:4))n=mt(i,e,r,h);else{const t=i.readOffset(h),s=pt(e)*r;if(i.covers(t,s))n=mt(i,e,r,t);else{n=mt(await this.getSlice(t,s),e,r,t)}}s=1===r&&-1===P.d.indexOf(t)&&e!==P.h.RATIONAL&&e!==P.h.SRATIONAL?n[0]:n,o[P.e[t]]=s}const l=function(t){const e=t.GeoKeyDirectory;if(!e)return null;const r={};for(let i=4;i<=4*e[3];i+=4){const n=P.i[e[i]],s=e[i+1]?P.e[e[i+1]]:null,o=e[i+2],a=e[i+3];let l=null;if(s){if(l=t[s],null==l)throw new Error(`Could not get value of geoKey '${n}'.`);"string"==typeof l?l=l.substring(a,a+o-1):l.subarray&&(l=l.subarray(a,a+o),1===o&&(l=l[0]))}else l=a;r[n]=l}return r}(o),h=i.readOffset(t+r+e*n);return new wt(o,l,h)}async requestIFD(t){if(this.ifdRequests[t])return this.ifdRequests[t];if(0===t)return this.ifdRequests[t]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[t];if(!this.ifdRequests[t-1])try{this.ifdRequests[t-1]=this.requestIFD(t-1)}catch(e){if(e instanceof yt)throw new yt(t);throw e}return this.ifdRequests[t]=(async()=>{const e=await this.ifdRequests[t-1];if(0===e.nextIFDByteOffset)throw new yt(t);return this.parseFileDirectoryAt(e.nextIFDByteOffset)})(),this.ifdRequests[t]}async getImage(t=0){const e=await this.requestIFD(t);return new j(e.fileDirectory,e.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let t=0,e=!0;for(;e;)try{await this.requestIFD(t),++t}catch(t){if(!(t instanceof yt))throw t;e=!1}return t}async getGhostValues(){const t=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const e="GDAL_STRUCTURAL_METADATA_SIZE=";let r=await this.getSlice(t,130);if(e===mt(r,P.h.ASCII,30,t)){const e=mt(r,P.h.ASCII,130,t).split("\n")[0],i=Number(e.split("=")[1].split(" ")[0])+e.length;i>130&&(r=await this.getSlice(t,i));const n=mt(r,P.h.ASCII,i,t);this.ghostValues={},n.split("\n").filter((t=>t.length>0)).map((t=>t.split("="))).forEach((([t,e])=>{this.ghostValues[t]=e}))}return this.ghostValues}static async fromSource(t,e,r){const i=(await t.fetch([{offset:0,length:1024}],r))[0],n=new H(i),s=n.getUint16(0,0);let o;if(18761===s)o=!0;else{if(19789!==s)throw new TypeError("Invalid byte order value.");o=!1}const a=n.getUint16(2,o);let l;if(42===a)l=!1;else{if(43!==a)throw new TypeError("Invalid magic number.");l=!0;if(8!==n.getUint16(4,o))throw new Error("Unsupported offset byte-size.")}const h=l?n.getUint64(8,o):n.getUint32(4,o);return new At(t,o,l,h,e)}close(){return"function"==typeof this.source.close&&this.source.close()}}async function It(t,e){return At.fromSource(function(t){return new ct(t)}(t),e)}var bt=r(264),vt=r.n(bt),St=r(201),Dt=r.n(St);const Et={viridis:new Uint8Array([68,1,84,255,68,2,86,255,69,4,87,255,69,5,89,255,70,7,90,255,70,8,92,255,70,10,93,255,70,11,94,255,71,13,96,255,71,14,97,255,71,16,99,255,71,17,100,255,71,19,101,255,72,20,103,255,72,22,104,255,72,23,105,255,72,24,106,255,72,26,108,255,72,27,109,255,72,28,110,255,72,29,111,255,72,31,112,255,72,32,113,255,72,33,115,255,72,35,116,255,72,36,117,255,72,37,118,255,72,38,119,255,72,40,120,255,72,41,121,255,71,42,122,255,71,44,122,255,71,45,123,255,71,46,124,255,71,47,125,255,70,48,126,255,70,50,126,255,70,51,127,255,70,52,128,255,69,53,129,255,69,55,129,255,69,56,130,255,68,57,131,255,68,58,131,255,68,59,132,255,67,61,132,255,67,62,133,255,66,63,133,255,66,64,134,255,66,65,134,255,65,66,135,255,65,68,135,255,64,69,136,255,64,70,136,255,63,71,136,255,63,72,137,255,62,73,137,255,62,74,137,255,62,76,138,255,61,77,138,255,61,78,138,255,60,79,138,255,60,80,139,255,59,81,139,255,59,82,139,255,58,83,139,255,58,84,140,255,57,85,140,255,57,86,140,255,56,88,140,255,56,89,140,255,55,90,140,255,55,91,141,255,54,92,141,255,54,93,141,255,53,94,141,255,53,95,141,255,52,96,141,255,52,97,141,255,51,98,141,255,51,99,141,255,50,100,142,255,50,101,142,255,49,102,142,255,49,103,142,255,49,104,142,255,48,105,142,255,48,106,142,255,47,107,142,255,47,108,142,255,46,109,142,255,46,110,142,255,46,111,142,255,45,112,142,255,45,113,142,255,44,113,142,255,44,114,142,255,44,115,142,255,43,116,142,255,43,117,142,255,42,118,142,255,42,119,142,255,42,120,142,255,41,121,142,255,41,122,142,255,41,123,142,255,40,124,142,255,40,125,142,255,39,126,142,255,39,127,142,255,39,128,142,255,38,129,142,255,38,130,142,255,38,130,142,255,37,131,142,255,37,132,142,255,37,133,142,255,36,134,142,255,36,135,142,255,35,136,142,255,35,137,142,255,35,138,141,255,34,139,141,255,34,140,141,255,34,141,141,255,33,142,141,255,33,143,141,255,33,144,141,255,33,145,140,255,32,146,140,255,32,146,140,255,32,147,140,255,31,148,140,255,31,149,139,255,31,150,139,255,31,151,139,255,31,152,139,255,31,153,138,255,31,154,138,255,30,155,138,255,30,156,137,255,30,157,137,255,31,158,137,255,31,159,136,255,31,160,136,255,31,161,136,255,31,161,135,255,31,162,135,255,32,163,134,255,32,164,134,255,33,165,133,255,33,166,133,255,34,167,133,255,34,168,132,255,35,169,131,255,36,170,131,255,37,171,130,255,37,172,130,255,38,173,129,255,39,173,129,255,40,174,128,255,41,175,127,255,42,176,127,255,44,177,126,255,45,178,125,255,46,179,124,255,47,180,124,255,49,181,123,255,50,182,122,255,52,182,121,255,53,183,121,255,55,184,120,255,56,185,119,255,58,186,118,255,59,187,117,255,61,188,116,255,63,188,115,255,64,189,114,255,66,190,113,255,68,191,112,255,70,192,111,255,72,193,110,255,74,193,109,255,76,194,108,255,78,195,107,255,80,196,106,255,82,197,105,255,84,197,104,255,86,198,103,255,88,199,101,255,90,200,100,255,92,200,99,255,94,201,98,255,96,202,96,255,99,203,95,255,101,203,94,255,103,204,92,255,105,205,91,255,108,205,90,255,110,206,88,255,112,207,87,255,115,208,86,255,117,208,84,255,119,209,83,255,122,209,81,255,124,210,80,255,127,211,78,255,129,211,77,255,132,212,75,255,134,213,73,255,137,213,72,255,139,214,70,255,142,214,69,255,144,215,67,255,147,215,65,255,149,216,64,255,152,216,62,255,155,217,60,255,157,217,59,255,160,218,57,255,162,218,55,255,165,219,54,255,168,219,52,255,170,220,50,255,173,220,48,255,176,221,47,255,178,221,45,255,181,222,43,255,184,222,41,255,186,222,40,255,189,223,38,255,192,223,37,255,194,223,35,255,197,224,33,255,200,224,32,255,202,225,31,255,205,225,29,255,208,225,28,255,210,226,27,255,213,226,26,255,216,226,25,255,218,227,25,255,221,227,24,255,223,227,24,255,226,228,24,255,229,228,25,255,231,228,25,255,234,229,26,255,236,229,27,255,239,229,28,255,241,229,29,255,244,230,30,255,246,230,32,255,248,230,33,255,251,231,35,255,253,231,37,255]),inferno:new Uint8Array([0,0,4,255,1,0,5,255,1,1,6,255,1,1,8,255,2,1,10,255,2,2,12,255,2,2,14,255,3,2,16,255,4,3,18,255,4,3,20,255,5,4,23,255,6,4,25,255,7,5,27,255,8,5,29,255,9,6,31,255,10,7,34,255,11,7,36,255,12,8,38,255,13,8,41,255,14,9,43,255,16,9,45,255,17,10,48,255,18,10,50,255,20,11,52,255,21,11,55,255,22,11,57,255,24,12,60,255,25,12,62,255,27,12,65,255,28,12,67,255,30,12,69,255,31,12,72,255,33,12,74,255,35,12,76,255,36,12,79,255,38,12,81,255,40,11,83,255,41,11,85,255,43,11,87,255,45,11,89,255,47,10,91,255,49,10,92,255,50,10,94,255,52,10,95,255,54,9,97,255,56,9,98,255,57,9,99,255,59,9,100,255,61,9,101,255,62,9,102,255,64,10,103,255,66,10,104,255,68,10,104,255,69,10,105,255,71,11,106,255,73,11,106,255,74,12,107,255,76,12,107,255,77,13,108,255,79,13,108,255,81,14,108,255,82,14,109,255,84,15,109,255,85,15,109,255,87,16,110,255,89,16,110,255,90,17,110,255,92,18,110,255,93,18,110,255,95,19,110,255,97,19,110,255,98,20,110,255,100,21,110,255,101,21,110,255,103,22,110,255,105,22,110,255,106,23,110,255,108,24,110,255,109,24,110,255,111,25,110,255,113,25,110,255,114,26,110,255,116,26,110,255,117,27,110,255,119,28,109,255,120,28,109,255,122,29,109,255,124,29,109,255,125,30,109,255,127,30,108,255,128,31,108,255,130,32,108,255,132,32,107,255,133,33,107,255,135,33,107,255,136,34,106,255,138,34,106,255,140,35,105,255,141,35,105,255,143,36,105,255,144,37,104,255,146,37,104,255,147,38,103,255,149,38,103,255,151,39,102,255,152,39,102,255,154,40,101,255,155,41,100,255,157,41,100,255,159,42,99,255,160,42,99,255,162,43,98,255,163,44,97,255,165,44,96,255,166,45,96,255,168,46,95,255,169,46,94,255,171,47,94,255,173,48,93,255,174,48,92,255,176,49,91,255,177,50,90,255,179,50,90,255,180,51,89,255,182,52,88,255,183,53,87,255,185,53,86,255,186,54,85,255,188,55,84,255,189,56,83,255,191,57,82,255,192,58,81,255,193,58,80,255,195,59,79,255,196,60,78,255,198,61,77,255,199,62,76,255,200,63,75,255,202,64,74,255,203,65,73,255,204,66,72,255,206,67,71,255,207,68,70,255,208,69,69,255,210,70,68,255,211,71,67,255,212,72,66,255,213,74,65,255,215,75,63,255,216,76,62,255,217,77,61,255,218,78,60,255,219,80,59,255,221,81,58,255,222,82,56,255,223,83,55,255,224,85,54,255,225,86,53,255,226,87,52,255,227,89,51,255,228,90,49,255,229,92,48,255,230,93,47,255,231,94,46,255,232,96,45,255,233,97,43,255,234,99,42,255,235,100,41,255,235,102,40,255,236,103,38,255,237,105,37,255,238,106,36,255,239,108,35,255,239,110,33,255,240,111,32,255,241,113,31,255,241,115,29,255,242,116,28,255,243,118,27,255,243,120,25,255,244,121,24,255,245,123,23,255,245,125,21,255,246,126,20,255,246,128,19,255,247,130,18,255,247,132,16,255,248,133,15,255,248,135,14,255,248,137,12,255,249,139,11,255,249,140,10,255,249,142,9,255,250,144,8,255,250,146,7,255,250,148,7,255,251,150,6,255,251,151,6,255,251,153,6,255,251,155,6,255,251,157,7,255,252,159,7,255,252,161,8,255,252,163,9,255,252,165,10,255,252,166,12,255,252,168,13,255,252,170,15,255,252,172,17,255,252,174,18,255,252,176,20,255,252,178,22,255,252,180,24,255,251,182,26,255,251,184,29,255,251,186,31,255,251,188,33,255,251,190,35,255,250,192,38,255,250,194,40,255,250,196,42,255,250,198,45,255,249,199,47,255,249,201,50,255,249,203,53,255,248,205,55,255,248,207,58,255,247,209,61,255,247,211,64,255,246,213,67,255,246,215,70,255,245,217,73,255,245,219,76,255,244,221,79,255,244,223,83,255,244,225,86,255,243,227,90,255,243,229,93,255,242,230,97,255,242,232,101,255,242,234,105,255,241,236,109,255,241,237,113,255,241,239,117,255,241,241,121,255,242,242,125,255,242,244,130,255,243,245,134,255,243,246,138,255,244,248,142,255,245,249,146,255,246,250,150,255,248,251,154,255,249,252,157,255,250,253,161,255,252,255,164,255]),turbo:new Uint8Array([48,18,59,255,50,21,67,255,51,24,74,255,52,27,81,255,53,30,88,255,54,33,95,255,55,36,102,255,56,39,109,255,57,42,115,255,58,45,121,255,59,47,128,255,60,50,134,255,61,53,139,255,62,56,145,255,63,59,151,255,63,62,156,255,64,64,162,255,65,67,167,255,65,70,172,255,66,73,177,255,66,75,181,255,67,78,186,255,68,81,191,255,68,84,195,255,68,86,199,255,69,89,203,255,69,92,207,255,69,94,211,255,70,97,214,255,70,100,218,255,70,102,221,255,70,105,224,255,70,107,227,255,71,110,230,255,71,113,233,255,71,115,235,255,71,118,238,255,71,120,240,255,71,123,242,255,70,125,244,255,70,128,246,255,70,130,248,255,70,133,250,255,70,135,251,255,69,138,252,255,69,140,253,255,68,143,254,255,67,145,254,255,66,148,255,255,65,150,255,255,64,153,255,255,62,155,254,255,61,158,254,255,59,160,253,255,58,163,252,255,56,165,251,255,55,168,250,255,53,171,248,255,51,173,247,255,49,175,245,255,47,178,244,255,46,180,242,255,44,183,240,255,42,185,238,255,40,188,235,255,39,190,233,255,37,192,231,255,35,195,228,255,34,197,226,255,32,199,223,255,31,201,221,255,30,203,218,255,28,205,216,255,27,208,213,255,26,210,210,255,26,212,208,255,25,213,205,255,24,215,202,255,24,217,200,255,24,219,197,255,24,221,194,255,24,222,192,255,24,224,189,255,25,226,187,255,25,227,185,255,26,228,182,255,28,230,180,255,29,231,178,255,31,233,175,255,32,234,172,255,34,235,170,255,37,236,167,255,39,238,164,255,42,239,161,255,44,240,158,255,47,241,155,255,50,242,152,255,53,243,148,255,56,244,145,255,60,245,142,255,63,246,138,255,67,247,135,255,70,248,132,255,74,248,128,255,78,249,125,255,82,250,122,255,85,250,118,255,89,251,115,255,93,252,111,255,97,252,108,255,101,253,105,255,105,253,102,255,109,254,98,255,113,254,95,255,117,254,92,255,121,254,89,255,125,255,86,255,128,255,83,255,132,255,81,255,136,255,78,255,139,255,75,255,143,255,73,255,146,255,71,255,150,254,68,255,153,254,66,255,156,254,64,255,159,253,63,255,161,253,61,255,164,252,60,255,167,252,58,255,169,251,57,255,172,251,56,255,175,250,55,255,177,249,54,255,180,248,54,255,183,247,53,255,185,246,53,255,188,245,52,255,190,244,52,255,193,243,52,255,195,241,52,255,198,240,52,255,200,239,52,255,203,237,52,255,205,236,52,255,208,234,52,255,210,233,53,255,212,231,53,255,215,229,53,255,217,228,54,255,219,226,54,255,221,224,55,255,223,223,55,255,225,221,55,255,227,219,56,255,229,217,56,255,231,215,57,255,233,213,57,255,235,211,57,255,236,209,58,255,238,207,58,255,239,205,58,255,241,203,58,255,242,201,58,255,244,199,58,255,245,197,58,255,246,195,58,255,247,193,58,255,248,190,57,255,249,188,57,255,250,186,57,255,251,184,56,255,251,182,55,255,252,179,54,255,252,177,54,255,253,174,53,255,253,172,52,255,254,169,51,255,254,167,50,255,254,164,49,255,254,161,48,255,254,158,47,255,254,155,45,255,254,153,44,255,254,150,43,255,254,147,42,255,254,144,41,255,253,141,39,255,253,138,38,255,252,135,37,255,252,132,35,255,251,129,34,255,251,126,33,255,250,123,31,255,249,120,30,255,249,117,29,255,248,114,28,255,247,111,26,255,246,108,25,255,245,105,24,255,244,102,23,255,243,99,21,255,242,96,20,255,241,93,19,255,240,91,18,255,239,88,17,255,237,85,16,255,236,83,15,255,235,80,14,255,234,78,13,255,232,75,12,255,231,73,12,255,229,71,11,255,228,69,10,255,226,67,10,255,225,65,9,255,223,63,8,255,221,61,8,255,220,59,7,255,218,57,7,255,216,55,6,255,214,53,6,255,212,51,5,255,210,49,5,255,208,47,5,255,206,45,4,255,204,43,4,255,202,42,4,255,200,40,3,255,197,38,3,255,195,37,3,255,193,35,2,255,190,33,2,255,188,32,2,255,185,30,2,255,183,29,2,255,180,27,1,255,178,26,1,255,175,24,1,255,172,23,1,255,169,22,1,255,167,20,1,255,164,19,1,255,161,18,1,255,158,16,1,255,155,15,1,255,152,14,1,255,149,13,1,255,146,11,1,255,142,10,1,255,139,9,2,255,136,8,2,255,133,7,2,255,129,6,2,255,126,5,2,255,122,4,3,255]),rainbow:{colors:["#96005A","#0000C8","#0019FF","#0098FF","#2CFF96","#97FF00","#FFEA00","#FF6F00","#FF0000"],positions:[0,.125,.25,.375,.5,.625,.75,.875,1]},jet:{colors:["#000083","#003CAA","#05FFFF","#FFFF00","#FA0000","#800000"],positions:[0,.125,.375,.625,.875,1]},hsv:{colors:["#ff0000","#fdff02","#f7ff02","#00fc04","#00fc0a","#01f9ff","#0200fd","#0800fd","#ff00fb","#ff00f5","#ff0006"],positions:[0,.169,.173,.337,.341,.506,.671,.675,.839,.843,1]},hot:{colors:["#000000","#e60000","#ffd200","#ffffff"],positions:[0,.3,.6,1]},cool:{colors:["#00ffff","#ff00ff"],positions:[0,1]},spring:{colors:["#ff00ff","#ffff00"],positions:[0,1]},summer:{colors:["#008066","#ffff66"],positions:[0,1]},autumn:{colors:["#ff0000","#ffff00"],positions:[0,1]},winter:{colors:["#0000ff","#00ff80"],positions:[0,1]},bone:{colors:["#000000","#545474","#a9c8c8","#ffffff"],positions:[0,.376,.753,1]},copper:{colors:["#000000","#ffa066","#ffc77f"],positions:[0,.804,1]},greys:{colors:["#000000","#ffffff"],positions:[0,1]},ylgnbu:{colors:["#081d58","#253494","#225ea8","#1d91c0","#41b6c4","#7fcdbb","#c7e9b4","#edf8d9","#ffffd9"],positions:[0,.125,.25,.375,.5,.625,.75,.875,1]},greens:{colors:["#00441b","#006d2c","#238b45","#41ab5d","#74c476","#a1d99b","#c7e9c0","#e5f5e0","#f7fcf5"],positions:[0,.125,.25,.375,.5,.625,.75,.875,1]},ylorrd:{colors:["#800026","#bd0026","#e31a1c","#fc4e2a","#fd8d3c","#feb24c","#fed976","#ffeda0","#ffffcc"],positions:[0,.125,.25,.375,.5,.625,.75,.875,1]},bluered:{colors:["#0000ff","#ff0000"],positions:[0,1]},rdbu:{colors:["#050aac","#6a89f7","#bebebe","#dcaa84","#e6915a","#b20a1c"],positions:[0,.35,.5,.6,.7,1]},picnic:{colors:["#0000ff","#3399ff","#66ccff","#99ccff","#ccccff","#ffffff","#ffccff","#ff99ff","#ff66cc","#ff6666","#ff0000"],positions:[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1]},portland:{colors:["#0c3383","#0a88ba","#f2d338","#f28f38","#d91e1e"],positions:[0,.25,.5,.75,1]},blackbody:{colors:["#000000","#e60000","#e6d200","#ffffff","#a0c8ff"],positions:[0,.2,.4,.7,1]},earth:{colors:["#000082","#00b4b4","#28d228","#e6e632","#784614","#ffffff"],positions:[0,.1,.2,.4,.6,1]},electric:{colors:["#000000","#1e0064","#780064","#a05a00","#e6c800","#fffadc"],positions:[0,.15,.4,.6,.8,1]},magma:new Uint8Array([0,0,4,255,1,0,5,255,1,1,6,255,1,1,8,255,2,1,9,255,2,2,11,255,2,2,13,255,3,3,15,255,3,3,18,255,4,4,20,255,5,4,22,255,6,5,24,255,6,5,26,255,7,6,28,255,8,7,30,255,9,7,32,255,10,8,34,255,11,9,36,255,12,9,38,255,13,10,41,255,14,11,43,255,16,11,45,255,17,12,47,255,18,13,49,255,19,13,52,255,20,14,54,255,21,14,56,255,22,15,59,255,24,15,61,255,25,16,63,255,26,16,66,255,28,16,68,255,29,17,71,255,30,17,73,255,32,17,75,255,33,17,78,255,34,17,80,255,36,18,83,255,37,18,85,255,39,18,88,255,41,17,90,255,42,17,92,255,44,17,95,255,45,17,97,255,47,17,99,255,49,17,101,255,51,16,103,255,52,16,105,255,54,16,107,255,56,16,108,255,57,15,110,255,59,15,112,255,61,15,113,255,63,15,114,255,64,15,116,255,66,15,117,255,68,15,118,255,69,16,119,255,71,16,120,255,73,16,120,255,74,16,121,255,76,17,122,255,78,17,123,255,79,18,123,255,81,18,124,255,82,19,124,255,84,19,125,255,86,20,125,255,87,21,126,255,89,21,126,255,90,22,126,255,92,22,127,255,93,23,127,255,95,24,127,255,96,24,128,255,98,25,128,255,100,26,128,255,101,26,128,255,103,27,128,255,104,28,129,255,106,28,129,255,107,29,129,255,109,29,129,255,110,30,129,255,112,31,129,255,114,31,129,255,115,32,129,255,117,33,129,255,118,33,129,255,120,34,129,255,121,34,130,255,123,35,130,255,124,35,130,255,126,36,130,255,128,37,130,255,129,37,129,255,131,38,129,255,132,38,129,255,134,39,129,255,136,39,129,255,137,40,129,255,139,41,129,255,140,41,129,255,142,42,129,255,144,42,129,255,145,43,129,255,147,43,128,255,148,44,128,255,150,44,128,255,152,45,128,255,153,45,128,255,155,46,127,255,156,46,127,255,158,47,127,255,160,47,127,255,161,48,126,255,163,48,126,255,165,49,126,255,166,49,125,255,168,50,125,255,170,51,125,255,171,51,124,255,173,52,124,255,174,52,123,255,176,53,123,255,178,53,123,255,179,54,122,255,181,54,122,255,183,55,121,255,184,55,121,255,186,56,120,255,188,57,120,255,189,57,119,255,191,58,119,255,192,58,118,255,194,59,117,255,196,60,117,255,197,60,116,255,199,61,115,255,200,62,115,255,202,62,114,255,204,63,113,255,205,64,113,255,207,64,112,255,208,65,111,255,210,66,111,255,211,67,110,255,213,68,109,255,214,69,108,255,216,69,108,255,217,70,107,255,219,71,106,255,220,72,105,255,222,73,104,255,223,74,104,255,224,76,103,255,226,77,102,255,227,78,101,255,228,79,100,255,229,80,100,255,231,82,99,255,232,83,98,255,233,84,98,255,234,86,97,255,235,87,96,255,236,88,96,255,237,90,95,255,238,91,94,255,239,93,94,255,240,95,94,255,241,96,93,255,242,98,93,255,242,100,92,255,243,101,92,255,244,103,92,255,244,105,92,255,245,107,92,255,246,108,92,255,246,110,92,255,247,112,92,255,247,114,92,255,248,116,92,255,248,118,92,255,249,120,93,255,249,121,93,255,249,123,93,255,250,125,94,255,250,127,94,255,250,129,95,255,251,131,95,255,251,133,96,255,251,135,97,255,252,137,97,255,252,138,98,255,252,140,99,255,252,142,100,255,252,144,101,255,253,146,102,255,253,148,103,255,253,150,104,255,253,152,105,255,253,154,106,255,253,155,107,255,254,157,108,255,254,159,109,255,254,161,110,255,254,163,111,255,254,165,113,255,254,167,114,255,254,169,115,255,254,170,116,255,254,172,118,255,254,174,119,255,254,176,120,255,254,178,122,255,254,180,123,255,254,182,124,255,254,183,126,255,254,185,127,255,254,187,129,255,254,189,130,255,254,191,132,255,254,193,133,255,254,194,135,255,254,196,136,255,254,198,138,255,254,200,140,255,254,202,141,255,254,204,143,255,254,205,144,255,254,207,146,255,254,209,148,255,254,211,149,255,254,213,151,255,254,215,153,255,254,216,154,255,253,218,156,255,253,220,158,255,253,222,160,255,253,224,161,255,253,226,163,255,253,227,165,255,253,229,167,255,253,231,169,255,253,233,170,255,253,235,172,255,252,236,174,255,252,238,176,255,252,240,178,255,252,242,180,255,252,244,182,255,252,246,184,255,252,247,185,255,252,249,187,255,252,251,189,255,252,253,191,255]),plasma:new Uint8Array([13,8,135,255,16,7,136,255,19,7,137,255,22,7,138,255,25,6,140,255,27,6,141,255,29,6,142,255,32,6,143,255,34,6,144,255,36,6,145,255,38,5,145,255,40,5,146,255,42,5,147,255,44,5,148,255,46,5,149,255,47,5,150,255,49,5,151,255,51,5,151,255,53,4,152,255,55,4,153,255,56,4,154,255,58,4,154,255,60,4,155,255,62,4,156,255,63,4,156,255,65,4,157,255,67,3,158,255,68,3,158,255,70,3,159,255,72,3,159,255,73,3,160,255,75,3,161,255,76,2,161,255,78,2,162,255,80,2,162,255,81,2,163,255,83,2,163,255,85,2,164,255,86,1,164,255,88,1,164,255,89,1,165,255,91,1,165,255,92,1,166,255,94,1,166,255,96,1,166,255,97,0,167,255,99,0,167,255,100,0,167,255,102,0,167,255,103,0,168,255,105,0,168,255,106,0,168,255,108,0,168,255,110,0,168,255,111,0,168,255,113,0,168,255,114,1,168,255,116,1,168,255,117,1,168,255,119,1,168,255,120,1,168,255,122,2,168,255,123,2,168,255,125,3,168,255,126,3,168,255,128,4,168,255,129,4,167,255,131,5,167,255,132,5,167,255,134,6,166,255,135,7,166,255,136,8,166,255,138,9,165,255,139,10,165,255,141,11,165,255,142,12,164,255,143,13,164,255,145,14,163,255,146,15,163,255,148,16,162,255,149,17,161,255,150,19,161,255,152,20,160,255,153,21,159,255,154,22,159,255,156,23,158,255,157,24,157,255,158,25,157,255,160,26,156,255,161,27,155,255,162,29,154,255,163,30,154,255,165,31,153,255,166,32,152,255,167,33,151,255,168,34,150,255,170,35,149,255,171,36,148,255,172,38,148,255,173,39,147,255,174,40,146,255,176,41,145,255,177,42,144,255,178,43,143,255,179,44,142,255,180,46,141,255,181,47,140,255,182,48,139,255,183,49,138,255,184,50,137,255,186,51,136,255,187,52,136,255,188,53,135,255,189,55,134,255,190,56,133,255,191,57,132,255,192,58,131,255,193,59,130,255,194,60,129,255,195,61,128,255,196,62,127,255,197,64,126,255,198,65,125,255,199,66,124,255,200,67,123,255,201,68,122,255,202,69,122,255,203,70,121,255,204,71,120,255,204,73,119,255,205,74,118,255,206,75,117,255,207,76,116,255,208,77,115,255,209,78,114,255,210,79,113,255,211,81,113,255,212,82,112,255,213,83,111,255,213,84,110,255,214,85,109,255,215,86,108,255,216,87,107,255,217,88,106,255,218,90,106,255,218,91,105,255,219,92,104,255,220,93,103,255,221,94,102,255,222,95,101,255,222,97,100,255,223,98,99,255,224,99,99,255,225,100,98,255,226,101,97,255,226,102,96,255,227,104,95,255,228,105,94,255,229,106,93,255,229,107,93,255,230,108,92,255,231,110,91,255,231,111,90,255,232,112,89,255,233,113,88,255,233,114,87,255,234,116,87,255,235,117,86,255,235,118,85,255,236,119,84,255,237,121,83,255,237,122,82,255,238,123,81,255,239,124,81,255,239,126,80,255,240,127,79,255,240,128,78,255,241,129,77,255,241,131,76,255,242,132,75,255,243,133,75,255,243,135,74,255,244,136,73,255,244,137,72,255,245,139,71,255,245,140,70,255,246,141,69,255,246,143,68,255,247,144,68,255,247,145,67,255,247,147,66,255,248,148,65,255,248,149,64,255,249,151,63,255,249,152,62,255,249,154,62,255,250,155,61,255,250,156,60,255,250,158,59,255,251,159,58,255,251,161,57,255,251,162,56,255,252,163,56,255,252,165,55,255,252,166,54,255,252,168,53,255,252,169,52,255,253,171,51,255,253,172,51,255,253,174,50,255,253,175,49,255,253,177,48,255,253,178,47,255,253,180,47,255,253,181,46,255,254,183,45,255,254,184,44,255,254,186,44,255,254,187,43,255,254,189,42,255,254,190,42,255,254,192,41,255,253,194,41,255,253,195,40,255,253,197,39,255,253,198,39,255,253,200,39,255,253,202,38,255,253,203,38,255,252,205,37,255,252,206,37,255,252,208,37,255,252,210,37,255,251,211,36,255,251,213,36,255,251,215,36,255,250,216,36,255,250,218,36,255,249,220,36,255,249,221,37,255,248,223,37,255,248,225,37,255,247,226,37,255,247,228,37,255,246,230,38,255,246,232,38,255,245,233,38,255,245,235,39,255,244,237,39,255,243,238,39,255,243,240,39,255,242,242,39,255,241,244,38,255,241,245,37,255,240,247,36,255,240,249,33,255]),redblue:{colors:["#ff0000","#0000ff"],positions:[0,1]},coolwarm:{colors:["#0000ff","#ffffff","#ff0000"],positions:[0,.5,1]},diverging_1:{colors:["#400040","#3b004d","#36005b","#320068","#2d0076","#290084","#240091","#20009f","#1b00ad","#1600ba","#1200c8","#0d00d6","#0900e3","#0400f1","#0000ff","#0217ff","#042eff","#0645ff","#095cff","#0b73ff","#0d8bff","#10a2ff","#12b9ff","#14d0ff","#17e7ff","#19ffff","#3fffff","#66ffff","#8cffff","#b2ffff","#d8ffff","#ffffff","#ffffd4","#ffffaa","#ffff7f","#ffff54","#ffff2a","#ffff00","#ffed00","#ffdd00","#ffcc00","#ffba00","#ffaa00","#ff9900","#ff8700","#ff7700","#ff6600","#ff5400","#ff4400","#ff3300","#ff2100","#ff1100","#ff0000","#ff0017","#ff002e","#ff0045","#ff005c","#ff0073","#ff008b","#ff00a2","#ff00b9","#ff00d0","#ff00e7","#ff00ff"],positions:[0,.01587301587,.03174603174,.04761904761,.06349206348,.07936507935,.09523809522,.11111111109,.12698412696,.14285714283,.1587301587,.17460317457,.19047619044,.20634920631,.22222222218,.23809523805,.25396825392,.26984126979,.28571428566,.30158730153,.3174603174,.33333333327,.34920634914,.36507936501,.38095238088,.39682539675,.41269841262,.42857142849,.44444444436,.46031746023,.4761904761,.49206349197,.50793650784,.52380952371,.53968253958,.55555555545,.57142857132,.58730158719,.60317460306,.61904761893,.6349206348,.65079365067,.66666666654,.68253968241,.69841269828,.71428571415,.73015873002,.74603174589,.76190476176,.77777777763,.7936507935,.80952380937,.82539682524,.84126984111,.85714285698,.87301587285,.88888888872,.90476190459,.92063492046,.93650793633,.9523809522,.96825396807,.98412698394,1]},diverging_2:{colors:["#000000","#030aff","#204aff","#3c8aff","#77c4ff","#f0ffff","#f0ffff","#f2ff7f","#ffff00","#ff831e","#ff083d","#ff00ff"],positions:[0,1e-10,.1,.2,.3333,.4666,.5333,.6666,.8,.9,.999999999999,1]},blackwhite:{colors:["#000000","#ffffff"],positions:[0,1]},twilight:{colors:["#E2D9E2","#E0D9E2","#DDD9E0","#DAD8DF","#D6D7DD","#D2D5DB","#CDD3D8","#C8D0D6","#C2CED4","#BCCBD1","#B6C8CF","#B0C5CD","#AAC2CC","#A4BECA","#9EBBC9","#99B8C8","#93B4C6","#8EB1C5","#89ADC5","#85A9C4","#80A5C3","#7CA2C2","#789EC2","#759AC1","#7196C1","#6E92C0","#6C8EBF","#698ABF","#6786BE","#6682BD","#647DBC","#6379BB","#6275BA","#6170B9","#606CB8","#6067B6","#5F62B4","#5F5EB3","#5F59B1","#5E54AE","#5E4FAC","#5E4BA9","#5E46A6","#5D41A3","#5D3CA0","#5C379C","#5B3298","#5A2E93","#59298E","#572588","#562182","#531E7C","#511A75","#4E186F","#4B1668","#471461","#44135A","#411254","#3D114E","#3A1149","#371144","#351140","#33113C","#311339","#301437","#331237","#351138","#381139","#3B113B","#3F123D","#43123E","#481341","#4D1443","#521545","#571647","#5C1749","#61184B","#67194C","#6C1B4E","#711D4F","#761F4F","#7B2150","#802350","#852650","#8A2950","#8E2C50","#922F50","#963350","#9A3750","#9E3B50","#A13F50","#A54350","#A84750","#AB4B50","#AE5051","#B15452","#B35953","#B65D54","#B86255","#BA6657","#BC6B59","#BE705B","#C0755E","#C27A61","#C37F64","#C58468","#C6896C","#C78E71","#C89275","#C9977B","#CA9C80","#CCA186","#CDA68C","#CEAB92","#CFAF99","#D1B4A0","#D2B8A7","#D4BDAD","#D6C1B4","#D8C5BB","#D9C9C2","#DBCCC8","#DDD0CE","#DED3D3","#DFD5D8","#E0D7DB","#E1D8DF","#E2D9E1"],positions:[0,.0078740157,.0157480315,.0236220472,.031496063,.0393700787,.0472440945,.0551181102,.062992126,.0708661417,.0787401575,.0866141732,.094488189,.1023622047,.1102362205,.1181102362,.125984252,.1338582677,.1417322835,.1496062992,.157480315,.1653543307,.1732283465,.1811023622,.188976378,.1968503937,.2047244094,.2125984252,.2204724409,.2283464567,.2362204724,.2440944882,.2519685039,.2598425197,.2677165354,.2755905512,.2834645669,.2913385827,.2992125984,.3070866142,.3149606299,.3228346457,.3307086614,.3385826772,.3464566929,.3543307087,.3622047244,.3700787402,.3779527559,.3858267717,.3937007874,.4015748031,.4094488189,.4173228346,.4251968504,.4330708661,.4409448819,.4488188976,.4566929134,.4645669291,.4724409449,.4803149606,.4881889764,.4960629921,.5039370079,.5118110236,.5196850394,.5275590551,.5354330709,.5433070866,.5511811024,.5590551181,.5669291339,.5748031496,.5826771654,.5905511811,.5984251969,.6062992126,.6141732283,.6220472441,.6299212598,.6377952756,.6456692913,.6535433071,.6614173228,.6692913386,.6771653543,.6850393701,.6929133858,.7007874016,.7086614173,.7165354331,.7244094488,.7322834646,.7401574803,.7480314961,.7559055118,.7637795276,.7716535433,.7795275591,.7874015748,.7952755906,.8031496063,.811023622,.8188976378,.8267716535,.8346456693,.842519685,.8503937008,.8582677165,.8661417323,.874015748,.8818897638,.8897637795,.8976377953,.905511811,.9133858268,.9212598425,.9291338583,.937007874,.9448818898,.9527559055,.9606299213,.968503937,.9763779528,.9842519685,.9921259843,1]},twilight_shifted:{colors:["#301437","#32123A","#34113E","#361142","#391146","#3C114B","#3F1251","#421257","#46145E","#491564","#4C176B","#4F1972","#521C79","#551F7F","#572385","#58278B","#5A2B90","#5B3095","#5C359A","#5D3A9E","#5D3EA1","#5E43A5","#5E48A8","#5E4DAB","#5E52AD","#5F57B0","#5F5BB2","#5F60B4","#5F65B5","#6069B7","#606EB8","#6172BA","#6277BB","#637BBC","#657FBD","#6684BD","#6888BE","#6B8CBF","#6D90C0","#7094C0","#7398C1","#769CC1","#7AA0C2","#7EA4C3","#82A7C3","#87ABC4","#8CAFC5","#91B2C6","#96B6C7","#9CB9C8","#A1BDC9","#A7C0CB","#ADC3CD","#B3C6CE","#B9C9D0","#BFCCD3","#C5CFD5","#CBD2D7","#D0D4D9","#D4D6DC","#D8D8DE","#DCD9DF","#DED9E1","#E1D9E2","#E2D9E1","#E1D8DF","#E0D7DB","#DFD5D8","#DED3D3","#DDD0CE","#DBCCC8","#D9C9C2","#D8C5BB","#D6C1B4","#D4BDAD","#D2B8A7","#D1B4A0","#CFAF99","#CEAB92","#CDA68C","#CCA186","#CA9C80","#C9977B","#C89275","#C78E71","#C6896C","#C58468","#C37F64","#C27A61","#C0755E","#BE705B","#BC6B59","#BA6657","#B86255","#B65D54","#B35953","#B15452","#AE5051","#AB4B50","#A84750","#A54350","#A13F50","#9E3B50","#9A3750","#963350","#922F50","#8E2C50","#8A2950","#852650","#802350","#7B2150","#761F4F","#711D4F","#6C1B4E","#67194C","#61184B","#5C1749","#571647","#521545","#4D1443","#481341","#43123E","#3F123D","#3B113B","#381139","#351138","#331237","#301437"],positions:[0,.0078740157,.0157480315,.0236220472,.031496063,.0393700787,.0472440945,.0551181102,.062992126,.0708661417,.0787401575,.0866141732,.094488189,.1023622047,.1102362205,.1181102362,.125984252,.1338582677,.1417322835,.1496062992,.157480315,.1653543307,.1732283465,.1811023622,.188976378,.1968503937,.2047244094,.2125984252,.2204724409,.2283464567,.2362204724,.2440944882,.2519685039,.2598425197,.2677165354,.2755905512,.2834645669,.2913385827,.2992125984,.3070866142,.3149606299,.3228346457,.3307086614,.3385826772,.3464566929,.3543307087,.3622047244,.3700787402,.3779527559,.3858267717,.3937007874,.4015748031,.4094488189,.4173228346,.4251968504,.4330708661,.4409448819,.4488188976,.4566929134,.4645669291,.4724409449,.4803149606,.4881889764,.4960629921,.5039370079,.5118110236,.5196850394,.5275590551,.5354330709,.5433070866,.5511811024,.5590551181,.5669291339,.5748031496,.5826771654,.5905511811,.5984251969,.6062992126,.6141732283,.6220472441,.6299212598,.6377952756,.6456692913,.6535433071,.6614173228,.6692913386,.6771653543,.6850393701,.6929133858,.7007874016,.7086614173,.7165354331,.7244094488,.7322834646,.7401574803,.7480314961,.7559055118,.7637795276,.7716535433,.7795275591,.7874015748,.7952755906,.8031496063,.811023622,.8188976378,.8267716535,.8346456693,.842519685,.8503937008,.8582677165,.8661417323,.874015748,.8818897638,.8897637795,.8976377953,.905511811,.9133858268,.9212598425,.9291338583,.937007874,.9448818898,.9527559055,.9606299213,.968503937,.9763779528,.9842519685,.9921259843,1]}};function xt(t,e,r,i){this.message=t,this.expected=e,this.found=r,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,xt)}function _t(t,e){e=void 0!==e?e:{};var r,i={},n={Expression:q},s=q,o="+",a="-",l="*",h="/",c="**",f="(",u=")",g=/^[\-+]/,d=/^[0-9]/,p=/^[a-zA-Z_$]/,m=/^[a-zA-Z_$0-9]/,w=/^[ \t\n\r]/,y=j("+",!1),C=j("-",!1),A=j("*",!1),I=j("/",!1),b=j("**",!1),v=j("(",!1),S=j(")",!1),D=H("float"),E=H("integer"),x=H("identifier"),_=H("whitespace"),T=function(t,e){var r,i,n=t;for(r=0;r<e.length;r++)i=e[r][1],n=rt(n,e[r][3],i);return n},B=function(t,e){var r,i,n=t;for(r=0;r<e.length;r++)i=e[r][1],n=rt(n,e[r][3],i);return n},R=function(t){return t},G=function(t,e){return{fn:t,lhs:e}},F=function(){return parseFloat(V(),10)},O=function(){return parseInt(V(),10)},P=function(){return V()},M=0,k=0,U=[{line:1,column:1}],L=[],N=0;if("startRule"in e){if(!(e.startRule in n))throw new Error("Can't start parsing from rule \""+e.startRule+'".');s=n[e.startRule]}function V(){return t.substring(k,M)}function j(t,e){return{type:"literal",text:t,ignoreCase:e}}function H(t){return{type:"other",description:t}}function Z(e){var r,i=U[e];if(i)return i;for(r=e-1;!U[r];)r--;for(i={line:(i=U[r]).line,column:i.column};r<e;)10===t.charCodeAt(r)?(i.line++,i.column=1):i.column++,r++;return U[e]=i,i}var W,X,Y="string"==typeof e.filename&&e.filename.length>0;function K(t,r){var i={};Y&&(i.filename=e.filename);var n=Z(t);i.start={offset:t,line:n.line,column:n.column};var s=Z(r);return i.end={offset:r,line:s.line,column:s.column},i}function z(t){var e=L[L.length-1];M<e.pos||(M>e.pos&&(e.pos=M,e.variants=[]),e.variants.push(t))}function q(){var e,r,n,s,l,h,c,f,u=function(t){0===N&&z(t)};if(e=M,(r=J())!==i){for(n=[],s=M,l=et(),u(y),43===t.charCodeAt(M)?(h=o,M++):h=i,h===i&&(u(C),45===t.charCodeAt(M)?(h=a,M++):h=i),h!==i?(c=et(),(f=J())!==i?s=l=[l,h,c,f]:(M=s,s=i)):(M=s,s=i);s!==i;)n.push(s),s=M,l=et(),u(y),43===t.charCodeAt(M)?(h=o,M++):h=i,h===i&&(u(C),45===t.charCodeAt(M)?(h=a,M++):h=i),h!==i?(c=et(),(f=J())!==i?s=l=[l,h,c,f]:(M=s,s=i)):(M=s,s=i);k=e,e=T(r,n)}else M=e,e=i;return e}function J(){var e,r,n,s,o,a,c,f,u=function(t){0===N&&z(t)};if(e=M,(r=$())!==i){for(n=[],s=M,o=et(),u(A),42===t.charCodeAt(M)?(a=l,M++):a=i,a===i&&(u(I),47===t.charCodeAt(M)?(a=h,M++):a=i),a!==i?(c=et(),(f=$())!==i?s=o=[o,a,c,f]:(M=s,s=i)):(M=s,s=i);s!==i;)n.push(s),s=M,o=et(),u(A),42===t.charCodeAt(M)?(a=l,M++):a=i,a===i&&(u(I),47===t.charCodeAt(M)?(a=h,M++):a=i),a!==i?(c=et(),(f=$())!==i?s=o=[o,a,c,f]:(M=s,s=i)):(M=s,s=i);k=e,e=B(r,n)}else M=e,e=i;return e}function $(){var e,r,n,s,o,a,l,h,f=function(t){0===N&&z(t)};if(e=M,(r=Q())!==i){for(n=[],s=M,o=et(),f(b),t.substr(M,2)===c?(a=c,M+=2):a=i,a!==i?(l=et(),(h=Q())!==i?s=o=[o,a,l,h]:(M=s,s=i)):(M=s,s=i);s!==i;)n.push(s),s=M,o=et(),f(b),t.substr(M,2)===c?(a=c,M+=2):a=i,a!==i?(l=et(),(h=Q())!==i?s=o=[o,a,l,h]:(M=s,s=i)):(M=s,s=i);k=e,e=B(r,n)}else M=e,e=i;return e}function Q(){var e,r,n,s,o,a,l=function(t){0===N&&z(t)};return e=M,l(v),40===t.charCodeAt(M)?(r=f,M++):r=i,r!==i?(n=et(),(s=q())!==i?(o=et(),l(S),41===t.charCodeAt(M)?(a=u,M++):a=i,a!==i?(k=e,e=R(s)):(M=e,e=i)):(M=e,e=i)):(M=e,e=i),e===i&&(e=function(){var e,r,n,s,o,a,l=function(t){0===N&&z(t)};l(D),N++,e=M,r=[],g.test(t.charAt(M))?(n=t.charAt(M),M++):n=i;for(;n!==i;)r.push(n),g.test(t.charAt(M))?(n=t.charAt(M),M++):n=i;n=[],d.test(t.charAt(M))?(s=t.charAt(M),M++):s=i;if(s!==i)for(;s!==i;)n.push(s),d.test(t.charAt(M))?(s=t.charAt(M),M++):s=i;else n=i;if(n!==i)if(t.length>M?(s=t.charAt(M),M++):s=i,s!==i){if(o=[],d.test(t.charAt(M))?(a=t.charAt(M),M++):a=i,a!==i)for(;a!==i;)o.push(a),d.test(t.charAt(M))?(a=t.charAt(M),M++):a=i;else o=i;o!==i?(k=e,e=F()):(M=e,e=i)}else M=e,e=i;else M=e,e=i;return N--,e}(),e===i&&(e=function(){var e,r,n,s,o=function(t){0===N&&z(t)};o(E),N++,e=M,r=[],g.test(t.charAt(M))?(n=t.charAt(M),M++):n=i;for(;n!==i;)r.push(n),g.test(t.charAt(M))?(n=t.charAt(M),M++):n=i;n=[],d.test(t.charAt(M))?(s=t.charAt(M),M++):s=i;if(s!==i)for(;s!==i;)n.push(s),d.test(t.charAt(M))?(s=t.charAt(M),M++):s=i;else n=i;n!==i?(k=e,e=O()):(M=e,e=i);return N--,e}(),e===i&&(e=M,(r=tt())!==i?(l(v),40===t.charCodeAt(M)?(n=f,M++):n=i,n!==i&&(s=q())!==i?(l(S),41===t.charCodeAt(M)?(o=u,M++):o=i,o!==i?(k=e,e=G(r,s)):(M=e,e=i)):(M=e,e=i)):(M=e,e=i),e===i&&(e=tt())))),e}function tt(){var e,r,n,s,o,a;for(a=x,0===N&&z(a),N++,e=M,r=[],g.test(t.charAt(M))?(n=t.charAt(M),M++):n=i;n!==i;)r.push(n),g.test(t.charAt(M))?(n=t.charAt(M),M++):n=i;if(p.test(t.charAt(M))?(n=t.charAt(M),M++):n=i,n!==i){for(s=[],m.test(t.charAt(M))?(o=t.charAt(M),M++):o=i;o!==i;)s.push(o),m.test(t.charAt(M))?(o=t.charAt(M),M++):o=i;k=e,e=P()}else M=e,e=i;return N--,e}function et(){var e,r,n;for(n=_,0===N&&z(n),N++,e=[],w.test(t.charAt(M))?(r=t.charAt(M),M++):r=i;r!==i;)e.push(r),w.test(t.charAt(M))?(r=t.charAt(M),M++):r=i;return N--,e}function rt(t,e,r){if("number"==typeof t&&"number"==typeof e)switch(r){case"+":return t+e;case"-":return t-e;case"*":return t*e;case"/":return t/e;case"**":return Math.pow(t,e)}return{lhs:t,rhs:e,op:r}}if(L.push({pos:M,variants:[]}),(r=s())!==i&&M===t.length)return r;throw r!==i&&M<t.length&&z({type:"end"}),W=L[0],X=W.pos,function(t,e,r){return new xt(xt.buildMessage(t,e),t,e,r)}(W.variants,X<t.length?t.charAt(X):null,X<t.length?K(X,X+1):K(X,X))}!function(t,e){function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r}(xt,Error),xt.buildMessage=function(t,e){var r,i={literal:function(t){return'"'+s(t.text)+'"'},class:function(t){var e=t.parts.map((function(t){return Array.isArray(t)?o(t[0])+"-"+o(t[1]):o(t)}));return"["+(t.inverted?"^":"")+e+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description},not:function(t){return"not "+a(t.expected)}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function s(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function o(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function a(t){return i[t.type](t)}return"Expected "+function(t){var e,r,i=t.map(a);if(i.sort(),i.length>0){for(e=1,r=1;e<i.length;e++)i[e-1]!==i[e]&&(i[r]=i[e],r++);i.length=r}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(t)+" but "+(((r=e)?'"'+s(r)+'"':"end of input")+" found.")};var Tt=Object.defineProperty,Bt=(t,e,r)=>(((t,e,r)=>{e in t?Tt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r})(t,"symbol"!=typeof e?e+"":e,r),r);function Rt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Gt(t,e){return void 0!==t?t:e}function Ft(t,e,r){const i=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(i,e),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(i));const n=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(n,r),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(n));const s=t.createProgram();return t.attachShader(s,i),t.attachShader(s,n),t.linkProgram(s),s}function Ot(t,e,r,i,n){let s;return t&&(t.viewport(0,0,i,n),s=t.createTexture(),t.bindTexture(t.TEXTURE_2D,s),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.LUMINANCE,i,n,0,t.LUMINANCE,t.FLOAT,new Float32Array(r))),{textureData:s,width:i,height:n,data:r,id:e}}function Pt(t,e){t&&t.deleteTexture(e.textureData)}function Mt(t,e,r="continuous"){const i=Et[t];e.height=1;const n=e.getContext("2d"),s=8192;if(!n)throw new Error("Unable to get canvas context.");if("[object Object]"===Object.prototype.toString.call(i))if(e.width=s,"continuous"===r){const t=n.createLinearGradient(0,0,s,1);for(let e=0;e<i.colors.length;++e)t.addColorStop(i.positions[e],i.colors[e]);n.fillStyle=t,n.fillRect(0,0,s,1)}else{if("discrete"!==r)throw new Error("Invalid color scale type.");for(let t=0;t<i.colors.length;++t){const e=i.positions[t],r=i.positions[t+1],o=8182*e,a=r?8182*r:s;n.fillStyle=i.colors[t],n.fillRect(o,0,a-o,1)}}else{if("[object Uint8Array]"!==Object.prototype.toString.call(i))throw new Error("Color scale not defined.");{e.width=s;const t=n.createImageData(s,1);t.data.set(i),n.putImageData(t,0,0)}}}const kt="\nprecision mediump float;\n// our texture\nuniform sampler2D u_textureData;\nuniform sampler2D u_textureScale;\nuniform vec2 u_textureSize;\nuniform vec2 u_domain;\nuniform vec2 u_display_range;\nuniform bool u_apply_display_range;\nuniform float u_noDataValue;\nuniform bool u_clampLow;\nuniform bool u_clampHigh;\n// the texCoords passed in from the vertex shader.\nvarying vec2 v_texCoord;\n\nbool isnan( float val ) {\n  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;\n}\n\nvoid main() {\n  vec2 onePixel = vec2(1.0, 1.0) / u_textureSize;\n  float value = texture2D(u_textureData, v_texCoord)[0];\n  if(value < -3.402823466e+38) // Check for possible NaN value\n    gl_FragColor = vec4(0.0, 0, 0, 0.0);\n  else if (value == u_noDataValue || isnan(value))\n    gl_FragColor = vec4(0.0, 0, 0, 0.0);\n  else if (u_apply_display_range && (value < u_display_range[0] || value >= u_display_range[1]))\n        gl_FragColor = vec4(0.0, 0, 0, 0.0);\n  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))\n    gl_FragColor = vec4(0, 0, 0, 0);\n  else {\n    float normalisedValue = (value - u_domain[0]) / (u_domain[1] - u_domain[0]);\n    gl_FragColor = texture2D(u_textureScale, vec2(normalisedValue, 0));\n  }\n}";class Ut{constructor(t){if(Bt(this,"canvas"),Bt(this,"currentDataset"),Bt(this,"datasetCollection"),Bt(this,"gl"),Bt(this,"program"),Bt(this,"texCoordBuffer"),Bt(this,"ctx"),Bt(this,"displayRange"),Bt(this,"applyDisplayRange"),Bt(this,"matrix"),Bt(this,"colorScaleImage"),Bt(this,"domain"),Bt(this,"colorScaleCanvas"),Bt(this,"name"),Bt(this,"clampLow"),Bt(this,"clampHigh"),Bt(this,"textureScale"),Bt(this,"noDataValue"),Bt(this,"expressionAst"),Bt(this,"colorType","continuous"),Bt(this,"positionBuffer"),Bt(this,"programCache",{}),this.datasetCollection={},this.currentDataset=null,this.setCanvas(t.canvas),this.setColorType(t.type),Gt(t.useWebGL,!0)){const t=function(t,e){const r=["webgl","experimental-webgl"];let i=null;for(let n=0;n<r.length;++n){try{i=t.getContext(r[n],e)}catch(t){}if(i)break}return i&&i.getExtension("OES_texture_float")?i:null}(this.canvas,{premultipliedAlpha:!1});if(null!==t){this.gl=t,this.program=Ft(t,"\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\nvarying vec2 v_texCoord;\nvoid main() {\n  // apply transformation matrix\n  vec2 position = (u_matrix * vec3(a_position, 1)).xy;\n  // convert the rectangle from pixels to 0.0 to 1.0\n  vec2 zeroToOne = position / u_resolution;\n  // convert from 0->1 to 0->2\n  vec2 zeroToTwo = zeroToOne * 2.0;\n  // convert from 0->2 to -1->+1 (clipspace)\n  vec2 clipSpace = zeroToTwo - 1.0;\n  gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n  // pass the texCoord to the fragment shader\n  // The GPU will interpolate this value between points.\n  v_texCoord = a_texCoord;\n}",kt),t.useProgram(this.program);const e=t.getAttribLocation(this.program,"a_texCoord");this.texCoordBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.texCoordBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),t.STATIC_DRAW),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,2,t.FLOAT,!1,0,0),this.positionBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),t.STATIC_DRAW);const r=t.getAttribLocation(this.program,"a_position");t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0)}else this.ctx=this.canvas.getContext("2d")}else this.ctx=this.canvas.getContext("2d");if(t.colorScaleImage?this.setColorScaleImage(t.colorScaleImage):this.setColorScale(Gt(t.colorScale,"viridis")),this.setDomain(Gt(t.domain,[0,1])),this.displayRange=Gt(t.displayRange,[0,1]),this.applyDisplayRange=Gt(t.applyDisplayRange,!1),this.setClamp(Gt(t.clampLow,!0),t.clampHigh),this.setNoDataValue(t.noDataValue),t.data){const e=t.data.length;this.setData(t.data,Gt(t.width,t.data[e-2]),Gt(t.height,t.data[e-2]))}if(t.datasets)for(let e=0;e<t.datasets.length;++e){const r=t.datasets[e];this.addDataset(r.id,r.data,r.width,r.height)}t.matrix?this.matrix=t.matrix:this.matrix=[1,0,0,0,1,0,0,0,1]}getData(){const t=this.currentDataset;if(!t)throw new Error("No dataset available.");return t.data}atPoint(t,e){const r=this.currentDataset;if(!r)throw new Error("No dataset available.");if(t>=r.width||e>=r.height)throw new Error("Coordinates are outside of image bounds.");return r.data[e*r.width+t]}setData(t,e,r){this.currentDataset&&null===this.currentDataset.id&&Pt(this.gl,this.currentDataset),this.currentDataset=Ot(this.gl,null,t,e,r)}addDataset(t,e,r,i){if(this.datasetAvailable(t))throw new Error(`There is already a dataset registered with id '${t}'`);this.datasetCollection[t]=Ot(this.gl,t,e,r,i),this.currentDataset||(this.currentDataset=this.datasetCollection[t])}setCurrentDataset(t){if(!this.datasetAvailable(t))throw new Error(`No such dataset registered: '${t}'`);this.currentDataset&&null===this.currentDataset.id&&Pt(this.gl,this.currentDataset),this.currentDataset=this.datasetCollection[t]}removeDataset(t){const e=this.datasetCollection[t];if(!e)throw new Error(`No such dataset registered: '${t}'`);Pt(this.gl,e),this.currentDataset===e&&(this.currentDataset=null),delete this.datasetCollection[t]}removeAllDataset(){Object.keys(this.datasetCollection).forEach((t=>this.removeDataset(t)))}datasetAvailable(t){return Rt(this.datasetCollection,t)}getColorScaleImage(){return this.colorScaleImage}setCanvas(t){this.canvas=t||document.createElement("canvas")}setColorType(t){this.colorType=null!=t?t:"continuous"}setDomain(t){if(!t||2!==t.length)throw new Error("Invalid domain specified.");this.domain=t}setDisplayRange(t){if(!t||2!==t.length)throw new Error("Invalid view range specified.");this.displayRange=t,this.applyDisplayRange=!0}getCanvas(){return this.canvas}setColorScale(t){if(!Rt(Et,t))throw new Error(`No such color scale '${t}'`);this.colorScaleCanvas||(this.colorScaleCanvas=document.createElement("canvas"),this.colorScaleCanvas.width=256,this.colorScaleCanvas.height=1),Mt(t,this.colorScaleCanvas,this.colorType),this.name=t,this.setColorScaleImage(this.colorScaleCanvas)}setClamp(t,e){this.clampLow=t,this.clampHigh=void 0!==e?e:t}setColorScaleImage(t){this.colorScaleImage=t;const e=this.gl;e&&(this.textureScale&&e.deleteTexture(this.textureScale),this.textureScale=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.textureScale),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t))}setNoDataValue(t){this.noDataValue=t}render(){const t=this.canvas,e=this.currentDataset;t.width=e.width,t.height=e.height;let r=this.getExpressionIds();this.gl?this.renderWebGL(e,r):this.ctx&&this.render2D(e)}getExpressionIds(){if(!this.expressionAst)return null;const t=new Set,e=r=>{"string"==typeof r&&t.add(r.replace(/[+-]/g,"")),"string"==typeof r.lhs?t.add(r.lhs.replace(/[+-]/g,"")):"object"==typeof r.lhs&&e(r.lhs),"string"==typeof r.rhs?t.add(r.rhs.replace(/[+-]/g,"")):"object"==typeof r.rhs&&e(r.rhs)};return e(this.expressionAst),Array.from(t)}renderWebGL(t,e){const r=this.gl;r.viewport(0,0,t.width,t.height);const i=this.getOrCreateProgram(e);r.useProgram(i),this.setupTextures(i,e,t),this.setupUniforms(i),this.setupAttributes(i),r.drawArrays(r.TRIANGLES,0,6)}getOrCreateProgram(t){if(!this.expressionAst)return this.program;const e=JSON.stringify(this.expressionAst);if(this.programCache[e])return this.programCache[e];const r=this.createVertexShader(),i=this.createFragmentShader(t),n=Ft(this.gl,r,i);return this.programCache[e]=n,n}createVertexShader(){return"\n      attribute vec2 a_position;\n      attribute vec2 a_texCoord;\n      uniform mat3 u_matrix;\n      uniform vec2 u_resolution;\n      varying vec2 v_texCoord;\n      void main() {\n        vec2 position = (u_matrix * vec3(a_position, 1)).xy;\n        vec2 zeroToOne = position / u_resolution;\n        vec2 zeroToTwo = zeroToOne * 2.0;\n        vec2 clipSpace = zeroToTwo - 1.0;\n        gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n        v_texCoord = a_texCoord;\n      }\n    "}createFragmentShader(t){if(!t)return kt;const e=t=>"object"==typeof t?"**"===t.op?`pow(${e(t.lhs)}, ${e(t.rhs)})`:t.fn?`(${t.fn}(${e(t.lhs)}))`:`(${e(t.lhs)} ${t.op} ${e(t.rhs)})`:"string"==typeof t?`${t}_value`:`float(${t})`,r=e(this.expressionAst);return`\n      precision mediump float;\n      uniform sampler2D u_textureScale;\n      ${t.map((t=>`uniform sampler2D u_texture_${t};`)).join("\n")}\n      uniform vec2 u_textureSize;\n      uniform vec2 u_domain;\n      uniform vec2 u_display_range;\n      uniform bool u_apply_display_range;\n      uniform float u_noDataValue;\n      uniform bool u_clampLow;\n      uniform bool u_clampHigh;\n      varying vec2 v_texCoord;\n      void main() {\n        ${t.map((t=>`float ${t}_value = texture2D(u_texture_${t}, v_texCoord)[0];`)).join("\n")}\n        float value = ${r};\n\n        if (value == u_noDataValue)\n          gl_FragColor = vec4(0.0, 0, 0, 0.0);\n        else if (u_apply_display_range && (value < u_display_range[0] || value >= u_display_range[1]))\n          gl_FragColor = vec4(0.0, 0, 0, 0.0);\n        else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))\n          gl_FragColor = vec4(0, 0, 0, 0);\n        else {\n          float normalisedValue = (value - u_domain[0]) / (u_domain[1] - u_domain[0]);\n          gl_FragColor = texture2D(u_textureScale, vec2(normalisedValue, 0));\n        }\n      }\n    `}setupTextures(t,e,r){const i=this.gl;e?(i.uniform1i(i.getUniformLocation(t,"u_textureScale"),0),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.textureScale),e.forEach(((e,r)=>{const n=r+1,s=this.datasetCollection[e];if(!s)throw new Error(`No such dataset registered: '${e}'`);i.uniform1i(i.getUniformLocation(t,`u_texture_${e}`),n),i.activeTexture(i[`TEXTURE${n}`]),i.bindTexture(i.TEXTURE_2D,s.textureData)}))):(i.uniform1i(i.getUniformLocation(t,"u_textureData"),0),i.uniform1i(i.getUniformLocation(t,"u_textureScale"),1),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,r.textureData),i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,this.textureScale))}setupUniforms(t){const e=this.gl,r=this.canvas;e.uniform2f(e.getUniformLocation(t,"u_resolution"),r.width,r.height),e.uniform2fv(e.getUniformLocation(t,"u_domain"),this.domain),e.uniform2fv(e.getUniformLocation(t,"u_display_range"),this.displayRange),e.uniform1i(e.getUniformLocation(t,"u_apply_display_range"),+this.applyDisplayRange),e.uniform1i(e.getUniformLocation(t,"u_clampLow"),+this.clampLow),e.uniform1i(e.getUniformLocation(t,"u_clampHigh"),+this.clampHigh),e.uniform1f(e.getUniformLocation(t,"u_noDataValue"),this.noDataValue),e.uniformMatrix3fv(e.getUniformLocation(t,"u_matrix"),!1,this.matrix)}setupAttributes(t){const e=this.gl,r=this.canvas,i=e.getAttribLocation(t,"a_position"),n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0),function(t,e,r,i,n){const s=e,o=e+i,a=r,l=r+n;t.bufferData(t.ARRAY_BUFFER,new Float32Array([s,a,o,a,s,l,s,l,o,a,o,l]),t.STATIC_DRAW)}(e,0,0,r.width,r.height)}render2D(t){const e=this.ctx,r=this.canvas.width,i=this.canvas.height,n=e.createImageData(r,i),s=this.domain[1]-this.domain[0],o=this.colorScaleCanvas.width,a=this.colorScaleCanvas.getContext("2d").getImageData(0,0,o,1).data;let l;const h=t.data;for(let t=0;t<i;t++)for(let e=0;e<r;e++){const i=t*r+e;let c=Math.floor((h[i]-this.domain[0])/s*(o-1));l=255,c<0?(c=0,this.clampLow||(l=0)):c>255&&(c=255,this.clampHigh||(l=0)),(h[i]===this.noDataValue||h[i]!=h[i]||this.applyDisplayRange&&(h[i]<this.displayRange[0]||h[i]>=this.displayRange[1]))&&(l=0);const f=4*(t*r+e);n.data[f+0]=a[4*c],n.data[f+1]=a[4*c+1],n.data[f+2]=a[4*c+2],n.data[f+3]=Math.min(l,a[4*c+3])}e.putImageData(n,0,0)}renderDataset(t){return this.setCurrentDataset(t),this.render()}getColor(t){const e=this.colorScaleCanvas.width,r=this.colorScaleCanvas.getContext("2d").getImageData(0,0,e,1).data,i=this.domain[1]-this.domain[0];let n=Math.round((t-this.domain[0])/i*e),s=255;return n<0&&(n=0,this.clampLow||(s=0)),n>255&&(n=255,this.clampHigh||(s=0)),[r[4*n],r[4*n+1],r[4*n+2],s]}setExpression(t){t&&t.length?this.expressionAst=_t(t):this.expressionAst=null}destroy(){var t;null==(t=this.gl)||t.deleteProgram(this.program),this.removeAllDataset()}}function Lt(t){return Math.round(255*t)}function Nt(t){const e=o.a.fromCssColorString(t),{red:r,green:i,blue:n,alpha:s}=e;return[r,i,n,s].map((t=>Math.round(255*t)))}var Vt=Object.defineProperty,jt=(t,e,r)=>(((t,e,r)=>{e in t?Vt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r})(t,"symbol"!=typeof e?e+"":e,r),r);class Ht extends b.a{constructor(t){super(t),jt(this,"nativeRectangle");const{project:e,unproject:r}=t;this.nativeRectangle=new A.a(t.rectangleSouthwestInMeters.x,t.rectangleSouthwestInMeters.y,t.rectangleNortheastInMeters.x,t.rectangleNortheastInMeters.y),this._projection={ellipsoid:this.ellipsoid,project(t,r){const[i,n]=e([t.longitude,t.latitude].map(y.a.toDegrees)),s=t.height;return Dt.a.fromElements(i,n,s,r)},unproject(t,e){const[i,n]=r([t.x,t.y]),s=t.z;return vt.a.fromDegrees(i,n,s,e)}};const i=new Dt.a;t.rectangleSouthwestInMeters.clone(i);const n=new Dt.a;t.rectangleNortheastInMeters.clone(n);const s=new Dt.a(n.x,i.y),o=new Dt.a(i.x,n.y),a=this.projection.unproject(i),l=this.projection.unproject(s),h=this.projection.unproject(o),c=this.projection.unproject(n);this._rectangle=A.a.fromCartographicArray([a,l,h,c])}tileXYToNativeRectangle2(t,e,r){const i=this.tileXYToRectangle(t,e,r),n=this.projection,s=[n.project(new vt.a(i.west,i.south)),n.project(new vt.a(i.west,i.north)),n.project(new vt.a(i.east,i.north)),n.project(new vt.a(i.east,i.south))],o=s.map((t=>t.x)),a=s.map((t=>t.y));return new A.a(Math.min(...o),Math.min(...a),Math.max(...o),Math.max(...a))}tileXYToRectangle(t,e,r){const i=this.tileXYToNativeRectangle(t,e,r),n=this.projection,s=n.unproject(new Dt.a(i.west,i.south)),o=n.unproject(new Dt.a(i.west,i.north)),a=n.unproject(new Dt.a(i.east,i.north)),l=n.unproject(new Dt.a(i.east,i.south)),h=A.a.fromCartographicArray([s,o,a,l]);return h.east<h.west&&(h.east+=y.a.TWO_PI),h}}function Zt(t,e){const{method:r="nearest"}=e;switch(r){case"nearest":return function(t,e){const{sourceWidth:r,sourceHeight:i,targetWidth:n,targetHeight:s,window:o,buffer:a=0}=e,[l,h,c,f]=o,u=r-2*a,g=i-2*a,d=Wt(t,n,s);for(let e=0;e<s;e++)for(let i=0;i<n;i++){const o=a+(u*(l+i/n*(c-l))>>>0),p=a+(g*(h+e/s*(f-h))>>>0);d[e*n+i]=t[p*r+o]}return d}(t,e);case"bilinear":return function(t,e){const{sourceWidth:r,sourceHeight:i,targetWidth:n,targetHeight:s,window:o,buffer:a=0,nodata:l}=e,[h,c,f,u]=o,g=f-h,d=u-c,p=Wt(t,n,s),m=r-2*a,w=i-2*a,y=1/n,C=1/s,A=t=>void 0!==l&&(0===l?0===t:Math.abs((t-l)/l)<1e-6);for(let e=0;e<s;e++){const s=w*(c+e*C*d)+a,o=Math.floor(s),f=Math.min(Math.ceil(s),i-a-1),u=s-o;for(let i=0;i<n;i++){const s=m*(h+i*y*g)+a,c=Math.floor(s),d=Math.min(Math.ceil(s),r-a-1),w=s-c,C=t[o*r+c],I=[t[o*r+c],t[o*r+d],t[f*r+c],t[f*r+d]];if(I.forEach(((t,e)=>{A(t)&&(I[e]=C)})),A(C)){p[e*n+i]=l;continue}const[b,v,S,D]=I,E=Xt(b,v,w),x=Xt(S,D,w),_=Xt(E,x,u);p[e*n+i]=_}}return p}(t,e)}}function Wt(t,e,r,i=1){return new(Object.getPrototypeOf(t).constructor)(e*r*i)}function Xt(t,e,r){return(1-r)*t+r*e}function Yt(t,e){return!(t<e[0]&&t<e[1]||t>e[0]&&t>e[1])}function Kt(t){const{data:e,sourceBBox:r,targetBBox:i,project:n,sourceWidth:s,sourceHeight:o,nodata:a}=t,{targetWidth:l=s,targetHeight:h=o}=t,[c,f,u,g]=r,[d,p,m,w]=i,y=Math.abs(u-c)/s,C=Math.abs(g-f)/o,A=Math.abs(m-d)/l,I=Math.abs(w-p)/h,b=Wt(e,l,h).fill(a);for(let t=0;t<h;t++)for(let r=0;r<l;r++){const i=d+A*(r+.5),o=w-I*(t+.5),[a,h]=n([i,o]);if(!Yt(a,[c,u])||!Yt(h,[c,g]))break;const f=e[~~((g-h)/C)*s+~~((a-c)/y)];b[t*l+r]=f}return b}function zt(t){return e=this,r=null,i=function*(){const{data:e,width:r,height:i,renderOptions:n,bands:s,noData:o,colorMapping:a}=t,l=new Uint8ClampedArray(r*i*4);function h(...t){return!!t.some((t=>isNaN(t)||t===o))}const{r:c,g:f,b:u}=null!=n?n:{},g=[c,f,u].map((t=>function(t,e){var r,i;const n=t[e.band];if(!n)throw new Error(`Invalid band${e.band}`);const s=null!=(r=null==e?void 0:e.min)?r:+n.min,o=null!=(i=null==e?void 0:e.max)?i:+n.max;return{min:s,max:o,range:o-s}}(s,t))),d=e[0],p=e[1],m=e[2];for(let t=0;t<e[0].length;t++){let e=Lt((d[t]-g[0].min)/g[0].range),r=Lt((p[t]-g[1].min)/g[1].range),i=Lt((m[t]-g[2].min)/g[2].range),n=h(d[t],p[t],m[t])?0:255;a.map((([t,s])=>{e===t[0]&&r===t[1]&&i===t[2]&&(e=s[0],r=s[1],i=s[2],n=s[3])})),l[4*t]=e,l[4*t+1]=r,l[4*t+2]=i,l[4*t+3]=n}return new ImageData(l,r,i)},new Promise(((t,n)=>{var s=t=>{try{a(i.next(t))}catch(t){n(t)}},o=t=>{try{a(i.throw(t))}catch(t){n(t)}},a=e=>e.done?t(e.value):Promise.resolve(e.value).then(s,o);a((i=i.apply(e,r)).next())}));var e,r,i}function qt(t,e){if("OffscreenCanvas"in window)return new OffscreenCanvas(t,e);{const r=document.createElement("canvas");return r.width=t,r.height=e,r}}function Jt(t,e,r){var i=void 0===e?null:e,n=function(t,e){var r=atob(t);if(e){for(var i=new Uint8Array(r.length),n=0,s=r.length;n<s;++n)i[n]=r.charCodeAt(n);return String.fromCharCode.apply(null,new Uint16Array(i.buffer))}return r}(t,void 0!==r&&r),s=n.indexOf("\n",10)+1,o=n.substring(s)+(i?"//# sourceMappingURL="+i:""),a=new Blob([o],{type:"application/javascript"});return URL.createObjectURL(a)}var $t,Qt,te,ee,re=($t="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgZnVuY3Rpb24gcmVzYW1wbGVOZWFyZXN0KGRhdGEsIG9wdGlvbnMpIHsKICAgIGNvbnN0IHsgc291cmNlV2lkdGgsIHNvdXJjZUhlaWdodCwgdGFyZ2V0V2lkdGgsIHRhcmdldEhlaWdodCwgd2luZG93LCBidWZmZXIgPSAwIH0gPSBvcHRpb25zOwogICAgY29uc3QgW3gwLCB5MCwgeDEsIHkxXSA9IHdpbmRvdzsKICAgIGNvbnN0IGVmZmVjdGl2ZVNvdXJjZVdpZHRoID0gc291cmNlV2lkdGggLSAyICogYnVmZmVyOwogICAgY29uc3QgZWZmZWN0aXZlU291cmNlSGVpZ2h0ID0gc291cmNlSGVpZ2h0IC0gMiAqIGJ1ZmZlcjsKICAgIGNvbnN0IHJlc2FtcGxlZERhdGEgPSBjb3B5TmV3U2l6ZShkYXRhLCB0YXJnZXRXaWR0aCwgdGFyZ2V0SGVpZ2h0KTsKICAgIGZvciAobGV0IHkgPSAwOyB5IDwgdGFyZ2V0SGVpZ2h0OyB5KyspIHsKICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCB0YXJnZXRXaWR0aDsgeCsrKSB7CiAgICAgICAgY29uc3QgY29sID0gYnVmZmVyICsgKGVmZmVjdGl2ZVNvdXJjZVdpZHRoICogKHgwICsgeCAvIHRhcmdldFdpZHRoICogKHgxIC0geDApKSA+Pj4gMCk7CiAgICAgICAgY29uc3Qgcm93ID0gYnVmZmVyICsgKGVmZmVjdGl2ZVNvdXJjZUhlaWdodCAqICh5MCArIHkgLyB0YXJnZXRIZWlnaHQgKiAoeTEgLSB5MCkpID4+PiAwKTsKICAgICAgICByZXNhbXBsZWREYXRhW3kgKiB0YXJnZXRXaWR0aCArIHhdID0gZGF0YVtyb3cgKiBzb3VyY2VXaWR0aCArIGNvbF07CiAgICAgIH0KICAgIH0KICAgIHJldHVybiByZXNhbXBsZWREYXRhOwogIH0KICBmdW5jdGlvbiByZXNhbXBsZURhdGEoZGF0YSwgb3B0aW9ucykgewogICAgY29uc3QgeyBtZXRob2QgPSAibmVhcmVzdCIgfSA9IG9wdGlvbnM7CiAgICBzd2l0Y2ggKG1ldGhvZCkgewogICAgICBjYXNlICJuZWFyZXN0IjoKICAgICAgICByZXR1cm4gcmVzYW1wbGVOZWFyZXN0KGRhdGEsIG9wdGlvbnMpOwogICAgICBjYXNlICJiaWxpbmVhciI6CiAgICAgICAgcmV0dXJuIHJlc2FtcGxlQmlsaW5lYXIoZGF0YSwgb3B0aW9ucyk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGNvcHlOZXdTaXplKGFycmF5LCB3aWR0aCwgaGVpZ2h0LCBzYW1wbGVzUGVyUGl4ZWwgPSAxKSB7CiAgICByZXR1cm4gbmV3IChPYmplY3QuZ2V0UHJvdG90eXBlT2YoYXJyYXkpKS5jb25zdHJ1Y3Rvcih3aWR0aCAqIGhlaWdodCAqIHNhbXBsZXNQZXJQaXhlbCk7CiAgfQogIGZ1bmN0aW9uIGxlcnAodjAsIHYxLCB0KSB7CiAgICByZXR1cm4gKDEgLSB0KSAqIHYwICsgdCAqIHYxOwogIH0KICBmdW5jdGlvbiByZXNhbXBsZUJpbGluZWFyKGRhdGEsIG9wdGlvbnMpIHsKICAgIGNvbnN0IHsgc291cmNlV2lkdGgsIHNvdXJjZUhlaWdodCwgdGFyZ2V0V2lkdGgsIHRhcmdldEhlaWdodCwgd2luZG93LCBidWZmZXIgPSAwLCBub2RhdGEgfSA9IG9wdGlvbnM7CiAgICBjb25zdCBbeDAsIHkwLCB4MSwgeTFdID0gd2luZG93OwogICAgY29uc3Qgd2luZG93V2lkdGggPSB4MSAtIHgwOwogICAgY29uc3Qgd2luZG93SGVpZ2h0ID0geTEgLSB5MDsKICAgIGNvbnN0IG5ld0FycmF5ID0gY29weU5ld1NpemUoZGF0YSwgdGFyZ2V0V2lkdGgsIHRhcmdldEhlaWdodCk7CiAgICBjb25zdCBlZmZlY3RpdmVTb3VyY2VXaWR0aCA9IHNvdXJjZVdpZHRoIC0gMiAqIGJ1ZmZlcjsKICAgIGNvbnN0IGVmZmVjdGl2ZVNvdXJjZUhlaWdodCA9IHNvdXJjZUhlaWdodCAtIDIgKiBidWZmZXI7CiAgICBjb25zdCBpbnZUYXJnZXRXaWR0aCA9IDEgLyB0YXJnZXRXaWR0aDsKICAgIGNvbnN0IGludlRhcmdldEhlaWdodCA9IDEgLyB0YXJnZXRIZWlnaHQ7CiAgICBjb25zdCBpc05vZGF0YSA9ICh2YWx1ZSkgPT4gewogICAgICBpZiAobm9kYXRhID09PSB2b2lkIDApCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICBpZiAobm9kYXRhID09PSAwKQogICAgICAgIHJldHVybiB2YWx1ZSA9PT0gMDsKICAgICAgcmV0dXJuIE1hdGguYWJzKCh2YWx1ZSAtIG5vZGF0YSkgLyBub2RhdGEpIDwgMWUtNjsKICAgIH07CiAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHRhcmdldEhlaWdodDsgeSsrKSB7CiAgICAgIGNvbnN0IHlSYXRpbyA9IHkgKiBpbnZUYXJnZXRIZWlnaHQ7CiAgICAgIGNvbnN0IHlNYXBwZWQgPSB5MCArIHlSYXRpbyAqIHdpbmRvd0hlaWdodDsKICAgICAgY29uc3QgcmF3WSA9IGVmZmVjdGl2ZVNvdXJjZUhlaWdodCAqIHlNYXBwZWQgKyBidWZmZXI7CiAgICAgIGNvbnN0IHlsID0gTWF0aC5mbG9vcihyYXdZKTsKICAgICAgY29uc3QgeWggPSBNYXRoLm1pbihNYXRoLmNlaWwocmF3WSksIHNvdXJjZUhlaWdodCAtIGJ1ZmZlciAtIDEpOwogICAgICBjb25zdCB0eSA9IHJhd1kgLSB5bDsKICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCB0YXJnZXRXaWR0aDsgeCsrKSB7CiAgICAgICAgY29uc3QgeFJhdGlvID0geCAqIGludlRhcmdldFdpZHRoOwogICAgICAgIGNvbnN0IHhNYXBwZWQgPSB4MCArIHhSYXRpbyAqIHdpbmRvd1dpZHRoOwogICAgICAgIGNvbnN0IHJhd1ggPSBlZmZlY3RpdmVTb3VyY2VXaWR0aCAqIHhNYXBwZWQgKyBidWZmZXI7CiAgICAgICAgY29uc3QgeGwgPSBNYXRoLmZsb29yKHJhd1gpOwogICAgICAgIGNvbnN0IHhoID0gTWF0aC5taW4oTWF0aC5jZWlsKHJhd1gpLCBzb3VyY2VXaWR0aCAtIGJ1ZmZlciAtIDEpOwogICAgICAgIGNvbnN0IHR4RnJhY3Rpb24gPSByYXdYIC0geGw7CiAgICAgICAgY29uc3QgY2VudGVyID0gZGF0YVt5bCAqIHNvdXJjZVdpZHRoICsgeGxdOwogICAgICAgIGNvbnN0IG5laWdoYm9ycyA9IFsKICAgICAgICAgIGRhdGFbeWwgKiBzb3VyY2VXaWR0aCArIHhsXSwKICAgICAgICAgIGRhdGFbeWwgKiBzb3VyY2VXaWR0aCArIHhoXSwKICAgICAgICAgIGRhdGFbeWggKiBzb3VyY2VXaWR0aCArIHhsXSwKICAgICAgICAgIGRhdGFbeWggKiBzb3VyY2VXaWR0aCArIHhoXQogICAgICAgIF07CiAgICAgICAgbmVpZ2hib3JzLmZvckVhY2goKG5laWdoYm9yLCBpbmRleCkgPT4gewogICAgICAgICAgaWYgKGlzTm9kYXRhKG5laWdoYm9yKSkgewogICAgICAgICAgICBuZWlnaGJvcnNbaW5kZXhdID0gY2VudGVyOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGlmIChpc05vZGF0YShjZW50ZXIpKSB7CiAgICAgICAgICBuZXdBcnJheVt5ICogdGFyZ2V0V2lkdGggKyB4XSA9IG5vZGF0YTsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgICBjb25zdCBbbGwsIGhsLCBsaCwgaGhdID0gbmVpZ2hib3JzOwogICAgICAgIGNvbnN0IHYwID0gbGVycChsbCwgaGwsIHR4RnJhY3Rpb24pOwogICAgICAgIGNvbnN0IHYxID0gbGVycChsaCwgaGgsIHR4RnJhY3Rpb24pOwogICAgICAgIGNvbnN0IHZhbHVlID0gbGVycCh2MCwgdjEsIHR5KTsKICAgICAgICBuZXdBcnJheVt5ICogdGFyZ2V0V2lkdGggKyB4XSA9IHZhbHVlOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gbmV3QXJyYXk7CiAgfQoKICBvbm1lc3NhZ2UgPSBmdW5jdGlvbihlKSB7CiAgICBjb25zdCB7IGRhdGEsIG9wdGlvbnMsIGlkIH0gPSBlLmRhdGE7CiAgICBjb25zdCByZXN1bHQgPSByZXNhbXBsZURhdGEoZGF0YSwgb3B0aW9ucyk7CiAgICBwb3N0TWVzc2FnZSh7IGRhdGE6IHJlc3VsdCwgaWQgfSk7CiAgfTsKCn0pKCk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPXdvcmtlci5qcy5tYXAKCg==",Qt=null,te=!1,function(t){return ee=ee||Jt($t,Qt,te),new Worker(ee,t)}),ie=Object.defineProperty,ne=(t,e,r)=>(((t,e,r)=>{e in t?ie(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r})(t,"symbol"!=typeof e?e+"":e,r),r);const se="undefined"!=typeof navigator&&navigator.hardwareConcurrency||2;class oe{constructor(t=se){if(ne(this,"workers"),ne(this,"size"),ne(this,"messageId"),this.workers=null,this.size=null!=t?t:0,this.messageId=0,t){this.workers=[];for(let e=0;e<t;e++)this.workers.push({worker:re(),idle:!0})}}resample(t,e){return r=this,i=null,n=function*(){return 0===this.size?Zt(t,e):new Promise((r=>{const i=this.workers.find((t=>t.idle))||this.workers[Math.floor(Math.random()*this.size)];i.idle=!1;const n=this.messageId++,s=t=>{t.data.id===n&&(i.idle=!0,r(t.data.data),i.worker.removeEventListener("message",s))};i.worker.addEventListener("message",s),i.worker.postMessage({data:t,options:e,id:n})}))},new Promise(((t,e)=>{var s=t=>{try{a(n.next(t))}catch(t){e(t)}},o=t=>{try{a(n.throw(t))}catch(t){e(t)}},a=e=>e.done?t(e.value):Promise.resolve(e.value).then(s,o);a((n=n.apply(r,i)).next())}));var r,i,n}destroy(){this.workers&&(this.workers.forEach((t=>{t.worker.terminate()})),this.workers=null)}}var ae=Object.defineProperty,le=Object.defineProperties,he=Object.getOwnPropertyDescriptors,ce=Object.getOwnPropertySymbols,fe=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable,ge=(t,e,r)=>e in t?ae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,de=(t,e)=>{for(var r in e||(e={}))fe.call(e,r)&&ge(t,r,e[r]);if(ce)for(var r of ce(e))ue.call(e,r)&&ge(t,r,e[r]);return t},pe=(t,e)=>le(t,he(e)),me=(t,e,r)=>(ge(t,"symbol"!=typeof e?e+"":e,r),r),we=(t,e,r)=>new Promise(((i,n)=>{var s=t=>{try{a(r.next(t))}catch(t){n(t)}},o=t=>{try{a(r.throw(t))}catch(t){n(t)}},a=t=>t.done?i(t.value):Promise.resolve(t.value).then(s,o);a((r=r.apply(t,e)).next())}));const ye=qt(256,256);class Ce{constructor(t){var e,r,i,n;this.options=t,me(this,"ready"),me(this,"tilingScheme"),me(this,"rectangle"),me(this,"tileSize"),me(this,"tileWidth"),me(this,"tileHeight"),me(this,"maximumLevel"),me(this,"minimumLevel"),me(this,"credit"),me(this,"errorEvent"),me(this,"readyPromise"),me(this,"bands"),me(this,"noData"),me(this,"hasAlphaChannel"),me(this,"plot"),me(this,"renderOptions"),me(this,"readSamples"),me(this,"requestLevels"),me(this,"bbox"),me(this,"_destroyed",!1),me(this,"_source"),me(this,"_imageCount"),me(this,"_images",[]),me(this,"_imagesCache",new Map),me(this,"_cacheSize"),me(this,"_isTiled"),me(this,"_proj"),me(this,"origin"),me(this,"reverseY",!1),me(this,"samples"),me(this,"workerPool"),me(this,"geotiffWorkerPool"),this.hasAlphaChannel=null==(e=t.hasAlphaChannel)||e,this.maximumLevel=null!=(r=t.maximumLevel)?r:18,this.minimumLevel=null!=(i=t.minimumLevel)?i:0,this.credit=new l.a(t.credit||"",!1),this.errorEvent=new d.a,this._cacheSize=null!=(n=t.cacheSize)?n:100,this.workerPool=new oe(t.workerPoolSize),this.geotiffWorkerPool=new T(t.workerPoolSize),this.ready=!1,c()(t.url)&&(this.readyPromise=this._build(t.url,t).then((()=>!0)))}get isDestroyed(){return this._destroyed}_build(t){return we(this,arguments,(function*(t,e={}){var r,i,s,o,a,l,h;const{tileSize:c,renderOptions:f,projFunc:g,requestOptions:d}=e;let p=yield t instanceof File||t instanceof Blob?It(t):async function(t,e={},r){return At.fromSource(ht(t,e),r)}(t,d),w=yield p.getImage();this._isTiled=w.isTiled,this._isTiled||"string"!=typeof t||(p=yield It(yield(yield fetch(t)).blob()),w=yield p.getImage()),this._source=p,this.origin=this._getOrigin(w),this.bbox=w.getBoundingBox(),this.reverseY=this._checkIfReversed(w);const[C,I,v,S]=this.bbox,D=+(null!=(r=w.geoKeys.ProjectedCSTypeGeoKey)?r:w.geoKeys.GeographicTypeGeoKey);if(this._proj=null==g?void 0:g(D),3857===D||900913===D)this.tilingScheme=new b.a({rectangleNortheastInMeters:new n.a(v,S),rectangleSouthwestInMeters:new n.a(C,I)});else if(4326===D)this.tilingScheme=new m.a({rectangle:A.a.fromDegrees(...this.bbox),numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1});else{if("function"!=typeof(null==(i=this._proj)?void 0:i.project)||"function"!=typeof(null==(s=this._proj)?void 0:s.unproject)){throw new u.a(`Unspported projection type: EPSG:${D}, please add projFunc parameter to handle projection`)}console.warn(`[Experimental] Reprojection EPSG:${D}`),this.tilingScheme=new Ht(de({rectangleNortheastInMeters:new n.a(v,S),rectangleSouthwestInMeters:new n.a(C,I)},this._proj))}this.rectangle=this.tilingScheme.rectangle,this.rectangle.east<this.rectangle.west&&(this.rectangle.east+=y.a.TWO_PI),this._imageCount=yield p.getImageCount(),this.tileSize=this.tileWidth=c||(this._isTiled?w.getTileWidth():w.getWidth())||256,this.tileHeight=c||(this._isTiled?w.getTileHeight():w.getHeight())||256,console.log(this.tileWidth,this.tileHeight),this.requestLevels=this._isTiled?yield this._getCogLevels():[0],this._images=new Array(this._imageCount).fill(null);const E=w.getSamplesPerPixel();this.samples=E,this.renderOptions=null!=f?f:{};const x=w.getGDALNoData();if(this.noData=null!=(o=this.renderOptions.nodata)?o:x,E<3&&this.renderOptions.convertToRGB){throw new u.a("Can not render the image as RGB, please check the convertToRGB parameter")}this.renderOptions.single||this.renderOptions.multi||this.renderOptions.convertToRGB||(this.renderOptions=de(E>2?{convertToRGB:!0}:{single:{band:1}},this.renderOptions)),this.renderOptions.single&&(this.renderOptions.single.band=null!=(a=this.renderOptions.single.band)?a:1);const{single:_,multi:T,convertToRGB:B}=this.renderOptions;this.readSamples=T?[T.r.band-1,T.g.band-1,T.b.band-1]:B?[0,1,2]:[_.band-1],(null==_?void 0:_.expression)&&(this.readSamples=function(t){const e=/b(\d+)/g,r=new Set;let i;for(;null!==(i=e.exec(t));)r.add(parseInt(i[1])-1);return Array.from(r).sort(((t,e)=>t-e))}(_.expression));const R={};yield Promise.all(this.readSamples.map((t=>we(this,null,(function*(){const e=w.getGDALMetadata(t),r=t+1;if((null==e?void 0:e.STATISTICS_MINIMUM)&&(null==e?void 0:e.STATISTICS_MAXIMUM))R[r]={min:+e.STATISTICS_MINIMUM,max:+e.STATISTICS_MAXIMUM};else{if(B&&(R[r]={min:0,max:255}),T){const t=T[Object.keys(T).find((t=>{var e;return(null==(e=T[t])?void 0:e.band)===r}))];if(void 0!==(null==t?void 0:t.min)&&void 0!==(null==t?void 0:t.max)){const{min:e,max:i}=t;R[r]={min:e,max:i}}}if(_&&!_.expression&&_.band===r&&_.domain&&(R[r]={min:_.domain[0],max:_.domain[1]}),!(null==_?void 0:_.expression)&&!R[r]){console.warn(`Can not get band${r} min/max, try to calculate min/max values, or setting ${_?"domain":"min / max"}`);const e=yield p.getImage(this.requestLevels[0]),i=(yield e.readRasters({samples:[t],pool:this.geotiffWorkerPool}))[0].filter((t=>!isNaN(t)));R[r]=function(t,e){let r,i;for(let n=0;n<t.length;n+=1){const s=t[n];s!==e&&(void 0!==r||void 0!==i?s<r?r=s:s>i&&(i=s):r=i=s)}return{min:r,max:i}}(i,x)}}}))))),this.bands=R;try{if(this.renderOptions.single){const t=this.bands[_.band];if(!_.expression&&!t)throw new u.a(`Invalid band${_.band}`);const e=null!=(l=_.domain)?l:[t.min,t.max];this.plot=new Ut(pe(de({canvas:ye},_),{domain:e})),this.plot.setNoDataValue(this.noData);const{expression:r,colors:i,colorScaleImage:n}=_;if(this.plot.setExpression(r),i){const t=function(t,e){let r;if("string"==typeof t[0])r=t.map(((e,r)=>[r/t.length,e]));else{const[i,n]=e;r=t.map((t=>[(t[0]-i)/(n-i),t[1]]))}r.sort(((t,e)=>t[0]-e[0]));let i=r.length-1;for(;i>1&&r[i][0]>=1&&r[i-1][0]>=1;)r.pop(),i--;return r[0][0]>0&&(r=[[0,r[0][1]],...r]),{colors:r.map((t=>t[1])),positions:r.map((t=>{let e=t[0];return e<0?0:e>1?1:e}))}}(i,(null==_?void 0:_.useRealValue)?e:[0,1]);!function(t,e,r){if(e.length!==r.length)throw new Error("Invalid color scale.");Et[t]={colors:e,positions:r}}("temp",t.colors,t.positions),this.plot.setColorScale("temp")}else n||this.plot.setColorScale(null!=(h=null==_?void 0:_.colorScale)?h:"blackwhite")}}catch(t){console.error(t),this.errorEvent.raiseEvent(t)}this.readyPromise=Promise.resolve(!0),this.ready=!0}))}static fromUrl(t){return we(this,arguments,(function*(t,e={}){const r=new Ce(e);return yield r._build(t,pe(de({},e),{url:void 0})),r}))}_getOrigin(t){try{return t.getOrigin().slice(0,2)}catch(e){return[0,t.fileDirectory.ImageLength]}}_checkIfReversed(t){const e=t.getFileDirectory().ModelPixelScale;if(e){if(e[1]<0)return!0}const r=t.getFileDirectory().ModelTransformation;if(r){const t=r[3];if(r[7]>t)return!0}return!1}_getCogLevels(){return we(this,null,(function*(){const t=[];let e=this._imageCount-1;for(let r=this._imageCount-1;r>=0;r--){const i=this._images[r]=yield this._source.getImage(r),n=i.getWidth(),s=i.getHeight(),o=Math.max(n,s);if(r===this._imageCount-1){const e=Math.ceil((o-this.tileSize)/this.tileSize);t.push(...new Array(e).fill(r))}if(o>.5*this.tileSize){e=r;break}}let r=e;for(;r>=0;)t.push(r--);return t}))}_loadTile(t,e,r){return we(this,null,(function*(){var i;let n=t,s=e,o=r,a=t,l=e;const h=this.requestLevels.length-1;o>h&&(o=h,n>>=r-h,s>>=r-h,a=n<<r-o,l=s<<r-o);const c=this.requestLevels[o];let f=this._images[c];f||(f=this._images[c]=yield this._source.getImage(c));const u=f.getWidth(),g=f.getHeight(),d=u/this.tilingScheme.getNumberOfXTilesAtLevel(o),p=g/this.tilingScheme.getNumberOfYTilesAtLevel(o);let m=[Math.round(n*d),Math.round(s*p),Math.round((n+1)*d),Math.round((s+1)*p)];if(this._proj&&this.tilingScheme instanceof Ht){const t=this.tilingScheme.tileXYToNativeRectangle2(n,s,o),e=this.tilingScheme.nativeRectangle;t.west-=e.width/u,t.east+=e.width/u,t.south-=e.height/g,t.north+=e.height/g,m=[~~((t.west-e.west)/e.width*u),~~((e.north-t.north)/e.height*g),~~((t.east-e.west)/e.width*u),~~((e.north-t.south)/e.height*g)]}this.reverseY&&(m=[m[0],g-m[3],m[2],g-m[1]]);m=[m[0]-1,m[1]-1,m[2]+1,m[3]+1];const w=m[2]-m[0],C=m[3]-m[1],A={window:m,pool:this.geotiffWorkerPool,samples:this.readSamples,fillValue:this.noData,interleave:!1};let I;try{if(this.renderOptions.convertToRGB?I=yield f.readRGB(A):(I=yield f.readRasters(A),this.reverseY&&(I=yield Promise.all(I.map((t=>function(t){const{array:e,width:r,height:i}=t,n=[];for(let t=i-1;t>=0;t--){const i=t*r,s=i+r,o=e.slice(i,s);n.push(...o)}return n}({array:t,width:I.width,height:I.height})))))),(null==(i=this._proj)?void 0:i.project)&&this.tilingScheme instanceof Ht){const t=this.tilingScheme.tileXYToNativeRectangle2(n,s,o),e=this.tilingScheme.tileXYToRectangle(n,s,o),r=[t.west,t.south,t.east,t.north],i=[e.west,e.south,e.east,e.north].map(y.a.toDegrees),a=[];for(let t=0;t<I.length;t++){const e=Kt({data:I[t],sourceWidth:w,sourceHeight:C,nodata:this.noData,project:this._proj.project,sourceBBox:r,targetBBox:i});a.push(e)}I=a}const h=1<<r-o,c=(t-a)/h,u=(e-l)/h,g=1/(1<<r-o),d=c+g,p=u+g;return I=yield Promise.all(I.map((t=>we(this,null,(function*(){return this.workerPool.resample(t,{sourceWidth:w,sourceHeight:C,targetWidth:this.tileWidth,targetHeight:this.tileHeight,window:[c,u,d,p],method:this.renderOptions.resampleMethod,buffer:1,nodata:this.noData})}))))),{data:I,width:this.tileWidth,height:this.tileHeight}}catch(t){throw this.errorEvent.raiseEvent(t),t}}))}requestImage(t,e,r){return we(this,null,(function*(){var i;if(!this.ready)throw new u.a("requestImage must not be called before the imagery provider is ready.");if(r<this.minimumLevel||r>this.maximumLevel)return;const n=`${t}_${e}_${r}`;if(this._imagesCache.has(n))return this._imagesCache.get(n);const{single:s,multi:o,convertToRGB:a}=this.renderOptions;try{const{width:l,height:h,data:c}=yield this._loadTile(t,e,r);if(this._destroyed||!l||!h)return;let f;if(o||a){const t={data:c,width:l,height:h,renderOptions:null!=o?o:["r","g","b"].reduce(((t,e,r)=>pe(de({},t),{[e]:{band:r+1,min:0,max:255}})),{}),bands:this.bands,noData:this.noData,colorMapping:Object.entries(null!=(i=this.renderOptions.colorMapping)?i:{black:"transparent"}).map((t=>t.map(Nt)))};f=yield zt(t)}else if(s&&this.plot){const{band:t=1}=s;this.plot.removeAllDataset(),this.readSamples.forEach(((t,e)=>{this.plot.addDataset(`b${t+1}`,c[e],l,h)})),s.expression?this.plot.render():this.plot.renderDataset(`b${t}`);const e=qt(this.tileWidth,this.tileHeight);e.getContext("2d").drawImage(this.plot.canvas,0,0),f=e}if(f){if(this._imagesCache.size>=this._cacheSize){const t=this._imagesCache.keys().next().value;this._imagesCache.delete(t)}this._imagesCache.set(n,f)}return f}catch(t){throw console.error(t),this.errorEvent.raiseEvent(t),t}}))}pickFeatures(t,e,r,i,n){return we(this,null,(function*(){if(!this.options.enablePickFeatures)return;const t=r>this.maximumLevel?this.maximumLevel:r,e=this.requestLevels[t];let s=this._images[e];s||(s=this._images[e]=yield this._source.getImage(e));const o=s.getWidth(),a=s.getHeight();let l,h,c;const{west:f,south:u,north:g,width:d}=this.rectangle;let p=i-f;i<f&&(p+=y.a.TWO_PI),l=~~(Math.abs(p/d)*o),h=~~(Math.abs((g-n)/(g-u))*a),c=[l,h,l+1,h+1],this.reverseY&&(h=a-h,c=[l,h-1,l+1,h]);const m={window:c,height:1,width:1,pool:this.geotiffWorkerPool,interleave:!1};let w;w=this.renderOptions.convertToRGB?yield s.readRGB(m):yield s.readRasters(m);const C=new S.a;C.name=`lon:${(i/Math.PI*180).toFixed(6)}, lat:${(n/Math.PI*180).toFixed(6)}`;const A={};return null==w||w.forEach(((t,e)=>{A[e]=null==t?void 0:t[0]})),C.data=A,w&&C.configureDescriptionFromProperties(A),[C]}))}destroy(){var t;if(this._imagesCache){for(const t in this._imagesCache)delete this._imagesCache[t];this._imagesCache.clear()}if(this.workerPool&&this.workerPool.destroy(),this.plot&&this.plot.gl){for(const t in this.plot.programCache)this.plot.gl.deleteProgram(this.plot.programCache[t]);this.plot.gl.deleteBuffer(this.plot.positionBuffer)}null==(t=this.plot)||t.destroy(),this._images=[],this._source=void 0,this._destroyed=!0}}},749:function(t,e,r){"use strict";r.d(e,"e",(function(){return i})),r.d(e,"f",(function(){return s})),r.d(e,"d",(function(){return o})),r.d(e,"g",(function(){return a})),r.d(e,"h",(function(){return l})),r.d(e,"j",(function(){return h})),r.d(e,"a",(function(){return c})),r.d(e,"c",(function(){return f})),r.d(e,"b",(function(){return u})),r.d(e,"i",(function(){return g}));const i={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},n={};for(const t in i)i.hasOwnProperty(t)&&(n[i[t]]=parseInt(t,10));const s={256:"SHORT",257:"SHORT",258:"SHORT",259:"SHORT",262:"SHORT",273:"LONG",274:"SHORT",277:"SHORT",278:"LONG",279:"LONG",282:"RATIONAL",283:"RATIONAL",284:"SHORT",286:"SHORT",287:"RATIONAL",296:"SHORT",297:"SHORT",305:"ASCII",306:"ASCII",338:"SHORT",339:"SHORT",513:"LONG",514:"LONG",1024:"SHORT",1025:"SHORT",2048:"SHORT",2049:"ASCII",3072:"SHORT",3073:"ASCII",33550:"DOUBLE",33922:"DOUBLE",34264:"DOUBLE",34665:"LONG",34735:"SHORT",34736:"DOUBLE",34737:"ASCII",42113:"ASCII"},o=[n.BitsPerSample,n.ExtraSamples,n.SampleFormat,n.StripByteCounts,n.StripOffsets,n.StripRowCounts,n.TileByteCounts,n.TileOffsets,n.SubIFDs],a={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},l={};for(const t in a)a.hasOwnProperty(t)&&(l[a[t]]=parseInt(t,10));const h={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},c={Unspecified:0,Assocalpha:1,Unassalpha:2},f={Version:0,AddCompression:1},u={None:0,Deflate:1,Zstandard:2},g={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},d={};for(const t in g)g.hasOwnProperty(t)&&(d[g[t]]=parseInt(t,10))},750:function(t,e,r){"use strict";r.d(e,"b",(function(){return i})),r.d(e,"a",(function(){return n}));class i{get ok(){return this.status>=200&&this.status<=299}get status(){throw new Error("not implemented")}getHeader(t){throw new Error("not implemented")}async getData(){throw new Error("not implemented")}}class n{constructor(t){this.url=t}async request({headers:t,signal:e}={}){throw new Error("request is not implemented")}}},889:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));class i{async fetch(t,e=void 0){return Promise.all(t.map((t=>this.fetchSlice(t,e))))}async fetchSlice(t){throw new Error(`fetching of slice ${t} not possible, not implemented`)}get fileSize(){return null}async close(){}}},890:function(t,e,r){"use strict";function i(t,e){for(const r in e)e.hasOwnProperty(r)&&(t[r]=e[r])}function n(t,e){if(t.length<e.length)return!1;return t.substr(t.length-e.length)===e}function s(t,e){const{length:r}=t;for(let i=0;i<r;i++)e(t[i],i)}function o(t){const e={};for(const r in t)if(t.hasOwnProperty(r)){e[t[r]]=r}return e}function a(t,e){const r=[];for(let i=0;i<t;i++)r.push(e(i));return r}async function l(t){return new Promise((e=>setTimeout(e,t)))}function h(t,e){const r=Array.isArray(t)?t:Array.from(t),i=Array.isArray(e)?e:Array.from(e);return r.map(((t,e)=>[t,i[e]]))}r.d(e,"c",(function(){return i})),r.d(e,"d",(function(){return n})),r.d(e,"e",(function(){return s})),r.d(e,"f",(function(){return o})),r.d(e,"g",(function(){return a})),r.d(e,"h",(function(){return l})),r.d(e,"i",(function(){return h})),r.d(e,"a",(function(){return c})),r.d(e,"b",(function(){return u}));class c extends Error{constructor(t){super(t),Error.captureStackTrace&&Error.captureStackTrace(this,c),this.name="AbortError"}}class f extends Error{constructor(t,e){super(e),this.errors=t,this.message=e,this.name="AggregateError"}}const u=f}}]);